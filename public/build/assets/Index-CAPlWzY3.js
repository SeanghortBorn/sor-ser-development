import{X as Ke,j as e,r as a,b as Dt,c as w,S as Et,x as ht}from"./app-BjqCgIyx.js";import{H as $t}from"./HeaderNavbar-BSaA-w0-.js";import{F as Ht}from"./Footer-D7swcTT_.js";import{B as Lt,Z as Ft,R as Pt}from"./zap-BRdN61Uw.js";import{M as Fe}from"./Modal-UDtqqqRR.js";import{c as Pe}from"./createLucideIcon-CMyWvhk4.js";import"./transition-02Kcjz_l.js";/**
 * @license lucide-react v0.543.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Bt=Pe("arrow-right",Wt);/**
 * @license lucide-react v0.543.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],pt=Pe("check",zt);/**
 * @license lucide-react v0.543.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],It=Pe("info",Ut);/**
 * @license lucide-react v0.543.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Vt=Pe("trash",Gt);function Ot(){const{auth:g}=Ke().props;return e.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-10",children:g.user?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-center ",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-semibold text-gray-600",children:["Triple your productivity with the"," ",e.jsx("span",{className:"text-blue-500 font-semibold",children:"Homophone Checker"})]}),e.jsx("p",{className:"text-gray-600 mt-4 max-w-6xl mx-auto",children:"SorSer's Homophone Checker uses AI to instantly fix grammar, spelling, and punctuation mistakes. Start typing, and the AI will detect and correct errors in real time, making your writing clear, accurate, and polished."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-9",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-semibold text-gray-600",children:["Triple your productivity with the"," ",e.jsx("span",{className:"text-blue-500 font-semibold",children:"Homophone Checker"})]}),e.jsx("p",{className:"text-gray-600 mt-4 max-w-6xl mx-auto",children:"SorSer's Homophone Checker uses AI to instantly fix grammar, spelling, and punctuation mistakes. Start typing, and the AI will detect and correct errors in real time, making your writing clear, accurate, and polished."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Lt,{className:"text-pink-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"How To Use SorSer Tool"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"SorSer's AI helps you write better by detecting and fixing grammar, spelling, and punctuation mistakes as you type. It works in real time, so you can focus on your ideas while the AI takes care of corrections."}),e.jsxs("div",{className:"bg-white border rounded-xl p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Sample Grammar Checker"}),e.jsxs("div",{className:"mt-1 p-3 rounded-xl border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-800 mb-1",children:"Typing Your Sentence:"}),e.jsx("div",{className:"text-gray-600 text-sm mb-2",children:"What key difference distinguishes isotopes from one another?"}),e.jsxs("ul",{className:"mt-2 text-sm text-gray-700 space-y-2",children:[e.jsxs("li",{children:["•"," ",e.jsx("span",{className:"underline decoration-red-500 decoration-2 underline-offset-4",children:"She go"})," ","to the office every morning."]}),e.jsxs("li",{children:["•"," ",e.jsxs("span",{className:"underline decoration-green-500 decoration-2 underline-offset-4",children:["She ",e.jsx("strong",{children:"goes"})]})," ","to the office every morning."]})]})]})]})]}),e.jsxs("div",{className:"space-y-9",children:[e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ft,{className:"text-orange-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Lightning Fast"})]}),e.jsx("p",{className:"text-gray-600",children:"Boost your writing speed with AI-powered grammar checking that instantly detects and fixes errors. SorSer helps you turn rough drafts into clear, polished text in seconds — no extra effort required"})]}),e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Pt,{className:"text-pink-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Features for Everyone"})]}),e.jsxs("p",{className:"text-gray-600",children:["Whether you're a student, teacher, or professional, SorSer makes writing easier and more accurate."," ",e.jsx("span",{className:"text-blue-600 cursor-pointer hover:underline",children:"Try it out"})," ","to experience real-time grammar, spelling, and punctuation checking that helps you write with confidence."]})]})]})]})]})})}function Rt(){return e.jsx("div",{className:"w-full max-w-7xl mx-auto text-left py-8 pl-2",children:e.jsxs("div",{className:"flex justify-between items-center text-md",children:[e.jsxs("span",{className:"text-gray-500 text-md",children:["Try it out above by using ",e.jsx("span",{className:"font-semibold",children:"handwritten notes."})]}),e.jsxs("span",{className:"text-gray-500 text-md",children:["Don't have any content? ","",e.jsx("button",{className:"text-blue-500 text-md hover:underline",children:"Create from scratch"})]})]})})}function qt({text:g="",onReplace:k,checkerId:F,comparisonResult:y,setComparisonResult:ne,articleId:B,isChecking:G=!1}){const[K,ie]=a.useState([]),[O,be]=a.useState(!1),[we,z]=a.useState(!1),[j,$]=a.useState(null),[Y,v]=a.useState(null),[ve,U]=a.useState(null),[We,Ye]=a.useState(""),[Be,ze]=a.useState("idle"),[Ne,Ue]=a.useState(null),[Ie,oe]=a.useState(0),[_e,Je]=a.useState([]),[Ge,le]=a.useState(""),[Se,Qe]=a.useState(null),[ce,de]=a.useState(!1),[V,Ae]=a.useState(null),[R,P]=a.useState(null),[ke,xe]=a.useState(!1),ue=Ke(),{auth:E}=ue.props||{},Te=n=>{if(n===0||!y)return;const s=y.comparison.filter(c=>c.type==="missing"||c.type==="replaced"||c.type==="extra");if(n>=s.length)return;const r=[s[n],...s.slice(0,n),...s.slice(n+1)],d=y.comparison.filter(c=>c.type!=="missing"&&c.type!=="replaced"&&c.type!=="extra"),l=[...r,...d];ne({...y,comparison:l})},Ce=(n,s,x=!1)=>{var h,b,T,S,D,M;if(!n||!k||!y)return;w.post("/api/track/comparison-action",{grammar_checker_id:F,article_id:B??null,action:s,comparison_type:n.type,user_word:((h=n.user_word)==null?void 0:h.user_word)||"",article_word:((b=n.article_word)==null?void 0:b.article_word)||"",word_position:((T=n.user_word)==null?void 0:T.user_index)||((S=n.article_word)==null?void 0:S.article_index),session_id:sessionStorage.getItem("sessionId")}).catch(f=>console.error("Track comparison action error:",f));let r=[...y.comparison],d=[...y.user_words];const l=r.findIndex(f=>f===n);if(l===-1)return;if(s==="dismiss"){const f=`${n.type}-${((D=n.user_word)==null?void 0:D.user_index)||"none"}-${((M=n.article_word)==null?void 0:M.article_index)||"none"}`;ie(W=>[...W,f]),r=r.filter((W,te)=>te!==l)}else if(s==="accept"){if(n.type==="missing"){const f=n.article_word.article_index;d.splice(f,0,n.actions.accept.result)}else if(n.type==="extra"){const f=n.user_word.user_index;typeof f=="number"&&d.splice(f,1)}else if(n.type==="replaced"){const f=n.user_word.user_index;typeof f=="number"&&(d[f]=n.actions.accept.result)}r=r.filter((f,W)=>W!==l)}if(r.filter(f=>f.type==="missing"||f.type==="replaced"||f.type==="extra").length===0&&!x){try{Ae(N({...y,comparison:r,user_words:d}))}catch{}K.length===0&&(d=[...y.article_words]),setTimeout(()=>{ne(null),ie([])},500)}else ne({...y,comparison:r,user_words:d});if(!x){const f=d.join("");k(f)}},Me=async()=>{var c,h,b,T,S,D,M,f,W,te,Z,$e,pe,fe,se,ge,ye;if(!y)return;const n=y.comparison.filter(o=>o.type==="missing"||o.type==="replaced"||o.type==="extra"),s=Math.max(...y.comparison.filter(o=>o.type==="same"||o.type==="replaced"||o.type==="extra").map(o=>o.index_compared),-1),x=n.filter(o=>o.type!=="missing"||o.index_compared<=s),r=[],d=[];for(const o of y.comparison){if(o.type==="same"){const je=((c=o.article_word)==null?void 0:c.article_word)||((h=o.user_word)==null?void 0:h.user_word)||"";je!==""&&r.push(je);continue}if(!x.includes(o))continue;if(o.type==="extra"){d.push({action:"accept",comparison_type:o.type,user_word:((b=o.user_word)==null?void 0:b.user_word)||"",article_word:((T=o.article_word)==null?void 0:T.article_word)||"",word_position:((S=o.user_word)==null?void 0:S.user_index)||((D=o.article_word)==null?void 0:D.article_index)});continue}o.type==="missing"&&d.push({action:"accept",comparison_type:o.type,user_word:((M=o.user_word)==null?void 0:M.user_word)||"",article_word:((f=o.article_word)==null?void 0:f.article_word)||"",word_position:((W=o.user_word)==null?void 0:W.user_index)||((te=o.article_word)==null?void 0:te.article_index)}),o.type==="replaced"&&d.push({action:"accept",comparison_type:o.type,user_word:((Z=o.user_word)==null?void 0:Z.user_word)||"",article_word:(($e=o.article_word)==null?void 0:$e.article_word)||"",word_position:((pe=o.user_word)==null?void 0:pe.user_index)||((fe=o.article_word)==null?void 0:fe.article_index)});const re=o.actions&&o.actions.accept&&o.actions.accept.result||((se=o.article_word)==null?void 0:se.article_word)||((ge=o.user_word)==null?void 0:ge.user_word)||"";re!==""&&r.push(re)}for(const o of d)try{await w.post("/api/track/comparison-action",{grammar_checker_id:F,article_id:B??null,action:o.action,comparison_type:o.comparison_type,user_word:o.user_word,article_word:o.article_word,word_position:o.word_position,session_id:sessionStorage.getItem("sessionId")})}catch(ae){console.error("Track comparison action error:",((ye=ae.response)==null?void 0:ye.data)??ae.message)}const l=r.join("");k(l),ne(null),ie([])},I=n=>n?n.normalize("NFD").replace(/[\u17BB-\u17D2]/g,"").replace(/\s+/g,"").toLowerCase():"",Ve=async()=>{var r,d;if(Y)return Y;z(!0);const n=["/homophones.json","/storage/homophones.json","/homophones/json"];let s=[];for(const l of n)try{const c=await w.get(l,{headers:{Accept:"application/json"}});if(s=((r=c.data)==null?void 0:r.homophones)??((d=c.data)==null?void 0:d.data)??(Array.isArray(c.data)?c.data:null)??(Array.isArray(Object.values(c.data))?Object.values(c.data):[]),s.length)break}catch{}const x={};return s.forEach(l=>{var b;const c=(b=l.word)==null?void 0:b.trim(),h=I(c);c&&(x[c]=l),h&&(x[h]=l)}),v(x),z(!1),x},C=async n=>{if(!n)return;$(null),be(!0),z(!0);const s=n.article_word&&n.article_word.article_word||n.user_word&&n.user_word.user_word||"";if(!s){$({word:"",notFound:!0}),z(!1);return}try{const x=await Ve();if(x[s]){$({...x[s],displayedWord:s}),z(!1);return}const r=I(s),d=r?x[r]:null;if(d){const c=(Array.isArray(d.homophone)?d.homophone:[]).includes(s);$(c?{...d,displayedWord:s,isHomophone:!0}:{word:s,notFound:!0})}else $({word:s,notFound:!0})}catch(x){console.error("openExplain error:",x),$({word:s,notFound:!0})}finally{z(!1)}},J=()=>{be(!1),$(null)},N=n=>{var S,D;if(!n||!Array.isArray(n.comparison))return{replaced:0,extra:0,missing:0,same:0,total:0,accuracy:null,avgPause:null};const s=n.comparison,x=s.filter(M=>M.type==="replaced").length,r=s.filter(M=>M.type==="extra").length,d=s.filter(M=>M.type==="missing").length,l=s.filter(M=>M.type==="same").length,c=Array.isArray(n.article_words)?n.article_words.length:s.length,h=c>0?Math.round(l/c*1e4)/100:null;let b=((S=n.metadata)==null?void 0:S.avg_pause_duration)??((D=n.metadata)==null?void 0:D.avgPause)??null;const T=b!=null&&!Number.isNaN(Number(b))?Math.round(Number(b)*100)/100:null;return{replaced:x,extra:r,missing:d,same:l,total:c,accuracy:h,avgPause:T}};a.useEffect(()=>{y&&Ae(N(y))},[y]);const[Oe,Q]=a.useState(null),[q,Re]=a.useState(!1);async function De(n){var x,r,d;if(!n||!n.trim())return null;const s=["/api/khmer-segment"];for(const l of s)try{const c=await w.post(l,{text:n},{headers:{"Content-Type":"application/json"}}),h=((x=c.data)==null?void 0:x.tokens)??((d=(r=c.data)==null?void 0:r.data)==null?void 0:d.tokens)??(Array.isArray(c.data)?c.data:null);if(Array.isArray(h))return h}catch{}return null}const me=n=>{const s=String(n||"").trim(),x=s.length,r=s?s.split(/\s+/).filter(Boolean).length:0,d=s?s.split(/[.!?]+/).map(S=>S.trim()).filter(Boolean).length:0,l=s?s.split(/\n+/).map(S=>S.trim()).filter(Boolean).length:0,c=r>0?Math.ceil(r/200*60):0,h=Math.floor(c/60),b=c%60,T=`${h} m ${b} s`;return{characters:x,words:r,sentences:d,paragraphs:l,readingTime:T,readingSeconds:c}};async function Ee(n){const s=String(n||"").trim();if(!s)return me(s);try{const x=await De(s),r=Array.isArray(x)?x.length:s.split(/\s+/).filter(Boolean).length,d=s.length,l=s?s.split(/[.!?]+/).map(D=>D.trim()).filter(Boolean).length:0,c=s?s.split(/\n+/).map(D=>D.trim()).filter(Boolean).length:0,h=r>0?Math.ceil(r/200*60):0,b=Math.floor(h/60),T=h%60,S=`${b} m ${T} s`;return{characters:d,words:r,sentences:l,paragraphs:c,readingTime:S,readingSeconds:h}}catch(x){return console.error("Khmer segmentation error:",x),me(s)}}const[qe,he]=a.useState(!1),u=Dt.useRef(null),Xe=async(n={})=>{var d;const s=V??N(y);if(!s||s.total===0||!F&&!B)return null;const x=await Ee(g),r={grammar_checker_id:F??null,article_id:B??null,accuracy:s.accuracy??null,replaced_count:s.replaced??0,extra_count:s.extra??0,missing_count:s.missing??0,avg_pause_duration:(R==null?void 0:R.avg_pause_duration)??s.avgPause??null,user_word_count:x.words??null,article_total_words:s.total??null,reading_time_seconds:x.readingSeconds??null};if(r.avg_pause_duration===null)try{const l=await ee();l&&typeof l.avg_pause_duration=="number"&&(r.avg_pause_duration=Number(l.avg_pause_duration))}catch{}if(qe)return null;he(!0);try{return await w.post("/api/accuracy",r,{headers:{Accept:"application/json"},withCredentials:!0}),!0}catch(l){return console.error("Save accuracy error:",((d=l==null?void 0:l.response)==null?void 0:d.data)??l),null}finally{he(!1)}},X=()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{Xe().catch(()=>{})},700)};a.useEffect(()=>{const n=V??N(y);if(!(!n||n.total===0)&&!(!F&&!B))return X(),()=>{u.current&&(clearTimeout(u.current),u.current=null)}},[V,y,g,F,B]),a.useEffect(()=>{if(!ce)return;ee(F).catch(()=>{});let n=!1;return Re(!0),Q(null),Ee(g).then(s=>{n||Q(s)}).catch(()=>{}).finally(()=>{n||Re(!1)}),()=>{n=!0}},[ce,V]);async function ee(n=null){var r;xe(!0),P(null);const s=["/api/user-activity-stats","/api/user-activities/stats","/api/track/stats","/user-activity-stats"],x=typeof sessionStorage<"u"?sessionStorage.getItem("sessionId"):null;for(const d of s)try{const l={};x&&(l.session_id=x),n&&(l.grammar_checker_id=n),B&&(l.article_id=B);const c=await w.get(d,{params:l,headers:{Accept:"application/json"}}),h=((r=c.data)==null?void 0:r.data)??c.data??null;if(h&&typeof h=="object")return P(h),xe(!1),h}catch{}return xe(!1),null}if(y){const n=y.comparison.filter(r=>r.type==="missing"||r.type==="replaced"||r.type==="extra"),s=Math.max(...y.comparison.filter(r=>r.type==="same"||r.type==="replaced"||r.type==="extra").map(r=>r.index_compared),-1),x=n.filter(r=>r.type!=="missing"||r.index_compared<=s);return e.jsxs("div",{className:"w-96 rounded-xl border border-gray-200 bg-white h-[75vh] flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 pt-4 pb-2 border-gray-200",children:[G?e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm animate-pulse mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}):e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"text-gray-800 text-base font-semibold",children:"Comparison Results"})}),G?e.jsxs("div",{className:"flex items-center space-x-2 animate-pulse mb-1",children:[e.jsx("div",{className:"h-8 w-20 bg-slate-200 rounded-lg"}),e.jsx("div",{className:"h-8 w-28 bg-slate-200 rounded-lg"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"text-sm text-blue-900 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["All"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:x.length})]}),e.jsxs("button",{className:"text-sm text-green-600 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["Differences"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:x.length})]})]}),e.jsx("div",{className:"border-b"})]}),e.jsx("div",{className:"space-y-2 px-4 py-0 mb-2 flex-1 overflow-y-auto hide-scrollbar",children:G?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}),[...Array(3)].map((r,d)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"h-3 w-24 bg-slate-200 rounded mb-3"}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("div",{className:"h-4 w-16 bg-slate-300 rounded"}),e.jsx("div",{className:"h-4 w-20 bg-slate-200 rounded"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"})]})]},d))]}):e.jsxs(e.Fragment,{children:[x.length>0&&e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsxs("span",{className:"text-red-500 text-sm font-semibold",children:[x.length," ","differences"]}),e.jsx("span",{className:"text-gray-600 text-sm ml-1",children:"found"})]}),e.jsx("button",{className:"border border-green-500 text-green-600 px-3 py-1 rounded-full text-xs font-medium hover:bg-green-50 transition",onClick:Me,children:"Accept all"})]}),x.map((r,d)=>{var l,c,h;return e.jsxs("div",{onClick:()=>Te(d),className:`bg-white rounded-xl p-3 border shadow-sm cursor-pointer transition ${d===0?"border-blue-500 border-2":"border-gray-200"}`,children:[e.jsxs("p",{className:"text-xs text-gray-500 font-medium mb-2",children:[r.type==="missing"&&"Missing Word (Expected word is missing)",r.type==="replaced"&&"Incorrect Word",r.type==="extra"&&"Extra Word (Unmatched in the article)"]}),e.jsxs("div",{className:`${r.type!=="missing"?"gap-2 ":""} mb-3 flex items-center `,children:[e.jsx("span",{className:`${r.type!=="missing"?"line-through ":""}text-base ${d===0?"text-red-500":"text-gray-500"}`,children:typeof((l=r.user_word)==null?void 0:l.user_word)=="string"&&r.user_word.user_word!==""?r.user_word.user_word:""}),e.jsx("span",{children:r.type!=="missing"&&e.jsx(Bt,{className:"w-4 h-4 text-slate-500"})}),e.jsx("span",{className:`text-base font-semibold ${d===0?"text-green-600":"text-green-700"}`,children:((c=r.article_word)==null?void 0:c.article_word)||"Removed"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-full flex items-center text-xs font-medium transition",onClick:b=>{b.stopPropagation(),Ce(r,"accept")},children:[e.jsx(pt,{className:"w-3.5 h-3.5 mr-1"})," ","Accept"]}),e.jsxs("button",{className:"flex items-center text-gray-700 hover:text-red-600 px-3 rounded-full border-2 hover:bg-red-50 text-xs font-medium transition",onClick:b=>{b.stopPropagation(),Ce(r,"dismiss")},children:[e.jsx(Vt,{className:"w-3.5 h-3.5 mr-1"})," ","Ignore"]}),((h=E==null?void 0:E.can)==null?void 0:h.student)&&e.jsxs("button",{onClick:b=>{b.stopPropagation(),C(r)},className:"flex items-center text-gray-700 hover:text-blue-600 px-3 py-1 rounded-full border-2 border-gray-300 hover:bg-blue-50 text-xs font-medium transition-colors duration-200 ease-in-out",children:[e.jsx(It,{className:"w-4 h-4 mr-1"})," ","Explain"]})]})]},`${r.index_compared}-${r.type}`)}),x.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pt,{className:"mt-20 w-12 h-12 text-green-500 mx-auto mb-3"}),e.jsx("h5",{className:"text-base font-semibold text-gray-700 mb-1",children:"Perfect Match!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your text matches the article exactly."})]})]})}),e.jsx(Fe,{show:O,onClose:J,maxWidth:"xl",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Explanation"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:J,"aria-label":"Close",children:"✕"})]})}),we?e.jsx("div",{className:"py-8 text-center",children:"Loading…"}):j?j.notFound?e.jsxs("div",{className:"text-sm text-gray-700",children:["No entry found for"," ",e.jsx("span",{className:"font-mono",children:j.word}),"."]}):e.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[j.displayedWord&&e.jsx("div",{children:e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-lg",children:j.displayedWord}),j.isHomophone&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(homophone of"," ",e.jsx("strong",{children:j.word}),")"]})," — ",j.shortDescription||`This word is commonly used to describe or refer to ${j.word}.`]})}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Part of Speech"}),e.jsx("div",{className:"text-sm",children:j.pos||"—"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Pronunciation"}),e.jsx("div",{className:"text-sm",children:j.pro||j.phoneme||"—"})]})]}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Homophones"}),e.jsx("div",{className:"text-sm",children:Array.isArray(j.homophone)?j.homophone.join(", "):"—"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"phoneme"}),e.jsx("div",{className:"text-sm",children:typeof j.phoneme=="string"&&j.phoneme.trim()?j.phoneme:Array.isArray(j.phoneme)&&j.phoneme.length?j.phoneme.join(", "):"—"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Definition"}),e.jsx("div",{className:"text-sm",children:j.definition||"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Example"}),e.jsx("div",{className:"text-sm",children:j.example||"—"})]})]}):e.jsx("div",{className:"py-6 text-center text-sm text-gray-500",children:"No data available."}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:J,className:"rounded-[10px] border-2 border-gray-300 px-6 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})})]})}return e.jsxs("div",{className:"w-96 rounded-xl border border-gray-200 bg-white h-[75vh] flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 pt-4 pb-2 border-gray-200",children:[G?e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm animate-pulse mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}):e.jsx("div",{className:"flex items-center justify-between font-semibold mb-3",children:g.split(" ").filter(n=>n.trim()).length<25?`Enter at least 25 words (${g.split(" ").filter(n=>n.trim()).length}/25)`:"Grammar Check Results"}),G?e.jsxs("div",{className:"flex items-center space-x-2 animate-pulse mb-1",children:[e.jsx("div",{className:"h-8 w-20 bg-slate-200 rounded-lg"}),e.jsx("div",{className:"h-8 w-28 bg-slate-200 rounded-lg"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"text-sm text-blue-900 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["All"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:"0"})]}),e.jsxs("button",{className:"text-sm text-green-600 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["Grammar"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:"0"})]})]}),e.jsx("div",{className:"border-b"})]}),e.jsx("div",{className:"space-y-2 px-4 py-0 mb-2 flex-1 overflow-y-auto hide-scrollbar",children:G?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}),[...Array(3)].map((n,s)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"h-3 w-24 bg-slate-200 rounded mb-3"}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("div",{className:"h-4 w-16 bg-slate-300 rounded"}),e.jsx("div",{className:"h-4 w-20 bg-slate-200 rounded"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"})]})]},s))]}):e.jsxs("div",{className:"text-center flex flex-col items-center justify-center h-full",children:[e.jsx("img",{src:"/images/binoculars-see.svg",alt:"Icon",className:"w-16 h-16"}),e.jsx("h5",{className:"text-base font-semibold text-gray-700",children:"Nothing to check yet!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get started by adding text to the editor"})]})})]})}function ts(){var it,ot,lt;const{auth:g}=Ke().props,k=(it=g==null?void 0:g.user)==null?void 0:it.id,[F,y]=a.useState(!1),[ne,B]=a.useState(!1),[G,K]=a.useState(!1),[ie,O]=a.useState(!1),[be,we]=a.useState(!1),[z,j]=a.useState([]),[$,Y]=a.useState(!1),[v,ve]=a.useState(null),[U,We]=a.useState([]),[Ye,Be]=a.useState(!1),[ze,Ne]=a.useState([]),[Ue,Ie]=a.useState(!1),[oe,_e]=a.useState(null),[Je,Ge]=a.useState(!1),[le,Se]=a.useState(null),[Qe,ce]=a.useState(!1),[de,V]=a.useState(null),[Ae,R]=a.useState(!1),[P,ke]=a.useState(null),[xe,ue]=a.useState(!1),[E,Te]=a.useState([]),[Ce,Me]=a.useState(!1),[I,Ve]=a.useState(""),[C,J]=a.useState(""),[N,Oe]=a.useState(null),[Q,q]=a.useState(!1),[Re,De]=a.useState([]),[me,Ee]=a.useState(!1),[qe,he]=a.useState([]),[u,Xe]=a.useState(null),[X,ee]=a.useState(!1),n=a.useRef(null),s=a.useRef(null),[x,r]=a.useState(null),[d,l]=a.useState(!1),[c,h]=a.useState(null),[b,T]=a.useState(null),[S,D]=a.useState(!1),[M,f]=a.useState(0),[W,te]=a.useState(0),[Z,$e]=a.useState(null),[pe,fe]=a.useState(null),se=a.useRef(!1),[ge,ye]=a.useState(null),[o,ae]=a.useState(()=>{var t,i;return((t=g==null?void 0:g.can)==null?void 0:t.student)===!0?!0:((i=g==null?void 0:g.can)==null?void 0:i.student)===!1?!1:typeof window<"u"&&window.__canAccessLibrary!==void 0?window.__canAccessLibrary:null});a.useEffect(()=>{if(o!==null||!(g!=null&&g.user))return;let t=!1;return(async()=>{try{const m=(await fetch(route("api.user.can-access-library"),{headers:{"X-Requested-With":"XMLHttpRequest"}})).ok;t||(ae(m),typeof window<"u"&&(window.__canAccessLibrary=m))}catch{t||ae(!1)}})(),()=>t=!0},[g==null?void 0:g.user,o]),a.useEffect(()=>{const t=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;$e(t);try{sessionStorage.setItem("sessionId",t)}catch{}},[]);const re=()=>{k&&w.get("/grammar-checkers",{headers:{Accept:"application/json"}}).then(t=>{const i=Array.isArray(t.data)?t.data:t.data.data||[];De(i)}).catch(t=>{var i;((i=t.response)==null?void 0:i.status)!==401&&console.error("Error fetching history:",t),De([])})};async function je(t=null){var i;if(t){R(!0);try{const m=["/api/user-activities/stats","/api/user-activity-stats","/api/stats/user-activities"];for(const A of m)try{const p=await w.get(A,{params:{grammar_checker_id:t},headers:{Accept:"application/json"}}),_=((i=p.data)==null?void 0:i.data)??p.data??null;if(_&&typeof _=="object"){V(_),R(!1);return}}catch{continue}V(null)}catch(m){console.error("Error fetching activity stats:",m),V(null)}finally{R(!1)}}}async function et(t=null){var i;if(t){ue(!0);try{const m=[`/api/user-homophone-accuracies?grammar_checker_id=${t}`,`/api/homophone-accuracies?grammar_checker_id=${t}`,`/api/accuracies?grammar_checker_id=${t}`];for(const A of m)try{const p=await w.get(A,{headers:{Accept:"application/json"}}),_=((i=p.data)==null?void 0:i.data)??p.data??null;if(_){const H=Array.isArray(_)?_[0]:_;if(H){ke(H),ue(!1);return}}}catch{continue}ke(null)}catch(m){console.error("Error fetching accuracy stats:",m),ke(null)}finally{ue(!1)}}}async function tt(t=null){var i;if(t){Me(!0);try{const m=await w.get("/api/user-comparison-activities",{params:{grammar_checker_id:t,limit:50},headers:{Accept:"application/json"}}),A=Array.isArray(m.data)?m.data:((i=m.data)==null?void 0:i.data)??[];Te(A)}catch(m){console.error("Error fetching comparison activities:",m),Te([])}finally{Me(!1)}}}const ft=async()=>{if(o===null){console.warn("Permission check still in progress, please try again");return}if(N)o===!0?(K(!0),await Promise.all([je(N),tt(N),et(N)])):(O(!0),await st());else{q(!0);try{await Ze(I,C),o===!0?(K(!0),setTimeout(async()=>{N&&await Promise.all([je(N),tt(N),et(N)])},0)):(O(!0),await st())}catch(t){console.error("Error during save:",t),q(!1)}}},st=async()=>{we(!0);try{const t=await w.get("/grammar-checkers",{headers:{Accept:"application/json"}}),i=Array.isArray(t.data)?t.data:t.data.data||[];j(i)}catch(t){console.error("Error fetching history:",t),j([])}finally{we(!1)}};async function gt(t=null){var i;if(t){Be(!0);try{const m=await w.get("/api/user-comparison-activities",{params:{grammar_checker_id:t,limit:50},headers:{Accept:"application/json"}}),A=Array.isArray(m.data)?m.data:((i=m.data)==null?void 0:i.data)??[];We(A)}catch(m){console.error("Error fetching history comparison activities:",m),We([])}finally{Be(!1)}}}async function yt(t=null){var i;if(t){Ie(!0);try{const m=["/api/user-audio-activities","/api/audio-activities"];for(const A of m)try{const p=await w.get(A,{params:{grammar_checker_id:t},headers:{Accept:"application/json"},validateStatus:H=>H<500}),_=Array.isArray(p.data)?p.data:((i=p.data)==null?void 0:i.data)??[];if(p.status===200){Ne(_);return}}catch{continue}Ne([])}catch(m){console.error("Error fetching history audio activities:",m),Ne([])}finally{Ie(!1)}}}async function jt(t=null){var i;if(!(!t||!k)){ce(!0);try{const m=[`/api/user-homophone-accuracies?grammar_checker_id=${t}&user_id=${k}`,`/api/homophone-accuracies?grammar_checker_id=${t}`,`/api/accuracies?grammar_checker_id=${t}`];for(const A of m)try{const p=await w.get(A,{headers:{Accept:"application/json"}}),_=((i=p.data)==null?void 0:i.data)??p.data??null;if(_){const H=Array.isArray(_)?_[0]:_;if(H&&H.accuracy!=null){Se(H);return}}}catch{continue}Se(null)}catch(m){console.error("Error fetching history detail accuracy:",m),Se(null)}finally{ce(!1)}}}async function bt(t=null){var i;if(t){Ge(!0);try{const m=["/api/user-activities/stats","/api/user-activity-stats","/api/stats/user-activities"];for(const A of m)try{const p=await w.get(A,{params:{grammar_checker_id:t},headers:{Accept:"application/json"}}),_=((i=p.data)==null?void 0:i.data)??p.data??null;if(_&&typeof _=="object"){_e(_);return}}catch{continue}_e(null)}catch(m){console.error("Error fetching history detail stats:",m),_e(null)}finally{Ge(!1)}}}const wt=async t=>{ve(t),Y(!0),await Promise.all([gt(t.id),yt(t.id),bt(t.id),jt(t.id)])};a.useEffect(()=>{k&&w.get("/api/articles",{headers:{Accept:"application/json"}}).then(t=>{he(Array.isArray(t.data)?t.data:t.data.data||[])}).catch(t=>{var i;((i=t.response)==null?void 0:i.status)!==401&&console.error("Error fetching articles:",t),he([])})},[k]),a.useEffect(()=>{re()},[k]),a.useEffect(()=>{if(!X)return;const t=i=>{n.current&&!n.current.contains(i.target)&&ee(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[X]);const He=a.useRef(),vt=async t=>{if(!t||!t.trim())return 0;try{const i=await w.post("/api/khmer-segment",{text:t},{headers:{"Content-Type":"application/json"}});return i.data&&Array.isArray(i.data.tokens)?i.data.tokens.length:t.trim().split(/\s+/).length}catch(i){return console.error("Khmer segment API error:",i),t.trim().split(/\s+/).length}},Nt=t=>Math.ceil(t/200*60),at=async()=>{if(!(!u||!C.trim())){D(!0);try{const t=await w.post("/api/compare",{article_id:u.id,userInput:C});t.data&&Array.isArray(t.data.comparison)?T(t.data):(console.error("Invalid comparison result format:",t.data),T(null))}catch(t){console.error("Error in comparison:",t),T(null)}finally{D(!1)}}},Ze=async(t,i)=>{var p,_,H,ct,dt,xt,ut,mt;if(!k)return;q(!0);const m=await vt(i),A={user_id:k,title:t??"",paragraph:i??"",word_count:m,incorrect_word_count:0,reading_time:Nt(m),article_id:u?u.id:null};if(N)try{const L=await w.patch(`/grammar-checkers/${N}`,A,{headers:{Accept:"application/json"}}),Le=((dt=L.data)==null?void 0:dt.id)??((ut=(xt=L.data)==null?void 0:xt.data)==null?void 0:ut.id)??N;Oe(Le),re(),ye(Date.now()),u&&i.trim()&&at()}catch(L){console.error("Save update error:",((mt=L.response)==null?void 0:mt.data)??L)}finally{q(!1)}else{if(se.current){q(!1);return}se.current=!0;try{const L=await w.post("/grammar-checkers",A,{headers:{Accept:"application/json"}}),Le=((p=L.data)==null?void 0:p.id)??((H=(_=L.data)==null?void 0:_.data)==null?void 0:H.id)??null;Le&&Oe(Le),re(),ye(Date.now()),u&&i.trim()&&at()}catch(L){console.error("Save Document error:",((ct=L.response)==null?void 0:ct.data)??L)}finally{se.current=!1,q(!1)}}};a.useEffect(()=>{if(!(!k||!I.trim()&&!C.trim()))return He.current&&clearTimeout(He.current),He.current=setTimeout(()=>{Ze(I,C)},700),()=>clearTimeout(He.current)},[I,C]),a.useEffect(()=>{y(!g.user)},[g.user]);const rt=async t=>{var m;if(Xe(t),ee(!1),Ve(t?t.title:""),h(null),!t){r(null);return}const i=t.audios_id;if(!i){r(null);return}try{const p=(m=(await w.get(`/api/audios/${i}`)).data)==null?void 0:m.data;p&&p.file_path?r(p.file_path):(r(null),h("Audio file not found"))}catch(A){console.error("Failed to fetch audio:",A),h("Unable to load audio for this article."),r(null)}s.current&&(s.current.pause(),s.current.currentTime=0),l(!1),N&&Ze(I,C)},_t=()=>{if(!x||!s.current){h("No audio available to play.");return}if(d){const t=Date.now();fe(t),s.current.pause(),l(!1),k&&(u!=null&&u.audios_id)&&w.post("/api/track/audio-activity",{audio_id:u.audios_id,article_id:u.id,grammar_checker_id:N??null,activity_type:"audio_pause",playback_position:s.current.currentTime,pause_duration:0,session_id:Z}).catch(i=>console.error("Track audio pause error:",i))}else{let t=0;pe&&(t=(Date.now()-pe)/1e3,fe(null)),s.current.play().then(()=>{l(!0),k&&(u!=null&&u.audios_id)&&w.post("/api/track/audio-activity",{audio_id:u.audios_id,article_id:u.id,grammar_checker_id:N??null,activity_type:"audio_play",playback_position:s.current.currentTime,pause_duration:t,session_id:Z}).catch(i=>console.error("Track audio play error:",i))}).catch(i=>{console.error("Playback failed:",i),h("Failed to play audio. Please try again."),l(!1)})}},St=()=>{s.current&&(s.current.currentTime,s.current.currentTime=Math.min(s.current.currentTime+10,s.current.duration),k&&(u!=null&&u.audios_id)&&w.post("/api/track/audio-activity",{audio_id:u.audios_id,article_id:u.id,grammar_checker_id:N??null,activity_type:"audio_forward",playback_position:s.current.currentTime,session_id:Z}).catch(t=>console.error("Track audio forward error:",t)))},At=()=>{s.current&&(s.current.currentTime,s.current.currentTime=Math.max(s.current.currentTime-10,0),k&&(u!=null&&u.audios_id)&&w.post("/api/track/audio-activity",{audio_id:u.audios_id,article_id:u.id,grammar_checker_id:N??null,activity_type:"audio_rewind",playback_position:s.current.currentTime,session_id:Z}).catch(t=>console.error("Track audio rewind error:",t)))},kt=()=>{s.current&&f(s.current.currentTime)},Tt=()=>{s.current&&te(s.current.duration)},Ct=()=>{l(!1),s.current&&(s.current.currentTime=0)},Mt=t=>{if(s.current){const i=t.currentTarget.getBoundingClientRect(),m=(t.clientX-i.left)/i.width;s.current.currentTime=m*s.current.duration}},nt=t=>{if(isNaN(t))return"0:00";const i=Math.floor(t/60),m=Math.floor(t%60);return`${i}:${m.toString().padStart(2,"0")}`};return a.useEffect(()=>{(!C.trim()||!u)&&T(null)},[C,u]),e.jsxs(e.Fragment,{children:[e.jsx(Et,{title:"Homophone Check"}),e.jsx($t,{}),e.jsx(Ot,{}),e.jsxs("section",{className:"relative py-4",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8",children:e.jsxs("div",{className:`flex flex-row gap-4 transition-all duration-300 ${F?"blur-sm":""}`,children:[e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 shadow-sm p-6 h-[75vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x?e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("audio",{ref:s,src:x,onTimeUpdate:kt,onLoadedMetadata:Tt,onEnded:Ct,className:"hidden"}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-xl px-3 py-1 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:_t,className:"w-6 h-6 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-full transition",children:d?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsxs("div",{className:"flex space-x-0",children:[e.jsx("button",{onClick:At,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full transition",title:"Back 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),e.jsx("path",{d:"M3 3v5h5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})}),e.jsx("button",{onClick:St,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full transition",title:"Forward 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e.jsx("path",{d:"M21 3v5h-5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:nt(M)}),e.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full cursor-pointer relative",onClick:Mt,children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${M/W*100||0}%`}})}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:nt(W)})]})]})})]}):e.jsx("div",{}),e.jsxs("div",{className:"relative w-64",ref:n,children:[e.jsxs("button",{type:"button",className:"w-full px-3 py-2.5 text-sm bg-white border border-gray-300 rounded-xl shadow-sm text-left flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>ee(!X),children:[u?u.title:"Select an Article",e.jsx("svg",{className:`w-4 h-4 ml-2 transition-transform ${X?"rotate-180":"rotate-0"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-60 overflow-y-auto hide-scrollbar",children:e.jsxs("div",{className:"px-2 py-2 space-y-1",children:[e.jsx("button",{type:"button",className:`w-full text-left px-4 py-2 text-sm rounded-xl transition ${u?"hover:bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700 font-medium"}`,onClick:()=>rt(null),children:"Select an Article"}),qe.map((t,i)=>e.jsxs("button",{type:"button",className:`w-full text-left px-4 py-2 text-sm rounded-lg transition ${u&&u.id===t.id?"bg-blue-100 text-blue-700 font-medium":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>rt(t),children:[e.jsx("span",{className:"font-mono text-gray-500",children:i+1}),". ",t.title]},t.id))]})})]})]}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{className:`w-full h-[54vh] text-md bg-white border border-gray-200 rounded-xl py-3 px-3 focus:outline-none focus:ring-1 focus:ring-blue-500 placeholder-gray-500 resize-none overflow-y-auto hide-scrollbar ${me?"min-h-[50vh]":""}`,placeholder:"Type your text here...",value:C,onChange:t=>J(t.target.value),onDoubleClick:()=>Ee(!me),disabled:!u})}),e.jsx("div",{className:"flex justify-end items-center mt-2",children:e.jsx("button",{type:"button",onClick:ft,disabled:Q||S||!C.trim()||o===null,className:`px-6 py-2 rounded-xl font-medium transition ${Q||S||!C.trim()||o===null?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:Q||S?"Checking...":"Save"})})]}),e.jsx(qt,{text:C,onReplace:J,checkerId:N,comparisonResult:b,setComparisonResult:T,articleId:u==null?void 0:u.id,isChecking:S})]})}),e.jsx(Fe,{show:G,onClose:()=>K(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Article Name: ",I||"Untitled document"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Date:"," ",ge?new Date(ge).toLocaleDateString():"—"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 text-sm text-gray-700",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-500",children:"Paragraph"}),e.jsx("div",{className:"mt-1 bg-slate-50 p-3 rounded text-sm leading-relaxed whitespace-pre-wrap break-words max-h-60 overflow-auto",children:C??"—"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"font-medium text-slate-500 mb-2",children:"Recent Events"}),e.jsx("div",{className:"w-full bg-white border rounded-lg",children:Ce?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"Loading recent events…"}):E.length===0?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"No recent events."}):e.jsx("div",{className:"max-h-40 overflow-y-auto hide-scrollbar",children:e.jsxs("table",{className:"w-full text-sm divide-y",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Type"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Action"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"User word"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Article word"})]})}),e.jsx("tbody",{children:E.map(t=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:t.comparison_type??" "}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${t.action==="accept"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.action??" "})}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:t.user_word??" "}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:t.article_word??" "})]},t.id))})]})})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Replaced:"," ",e.jsx("span",{className:"font-medium text-green-700",children:E.filter(t=>t.comparison_type==="replaced"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:E.filter(t=>t.comparison_type==="replaced"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Missing:"," ",e.jsx("span",{className:"font-medium text-green-700",children:E.filter(t=>t.comparison_type==="missing"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:E.filter(t=>t.comparison_type==="missing"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Extra:"," ",e.jsx("span",{className:"font-medium text-green-700",children:E.filter(t=>t.comparison_type==="extra"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:E.filter(t=>t.comparison_type==="extra"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Accuracy:"," ",e.jsx("span",{className:"font-medium text-gray-800",children:xe?"…":(P==null?void 0:P.accuracy)!=null?`${Number(P.accuracy).toFixed(2)}%`:"—"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Avg Pause (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Ae?"…":(de==null?void 0:de.avg_pause_duration)!=null?Number(de.avg_pause_duration).toFixed(2):"—"})]}),e.jsxs("div",{children:["Audio Plays:"," ",e.jsx("span",{className:"font-medium text-blue-700",children:"0"})]}),e.jsxs("div",{children:["Audio Pauses:"," ",e.jsx("span",{className:"font-medium text-orange-700",children:"0"})]}),e.jsxs("div",{children:["Reading Time (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:(P==null?void 0:P.reading_time_seconds)??"—"})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>K(!1),className:"rounded-[10px] border-2 border-gray-300 px-6 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})}),e.jsx(Fe,{show:ie,onClose:()=>O(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Homophone History"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700 text-lg mr-2",onClick:()=>O(!1),children:"✕"})]}),be?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"Loading history..."})}):z.length===0?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"No Homophone found."})}):e.jsx("div",{className:"overflow-x-auto max-h-[50vh] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"No"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Words"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Reading Time"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:z.map((t,i)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-600",children:i+1}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-800",children:t.title||"Untitled document"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:t.word_count??"0"}),e.jsxs("td",{className:"px-4 py-3 text-center text-gray-700",children:[t.reading_time??"0","s"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{type:"button",className:"rounded-[10px] border-2 border-blue-500 px-3 py-1 text-blue-700 hover:bg-blue-500 hover:text-white transition font-medium",onClick:()=>wt(t),children:"View"})})]},t.id))})]})}),e.jsx("div",{className:"mt-6 flex justify-end px-6",children:e.jsx("button",{onClick:()=>O(!1),className:"rounded-[10px] border-2 border-gray-500 px-4 py-1 text-gray-600 hover:bg-gray-500 hover:text-white transition font-medium",children:"Close"})})]})}),$&&v&&e.jsx(Fe,{show:$,onClose:()=>{Y(!1),ve(null)},maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:(v==null?void 0:v.title)||"Untitled document"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:v!=null&&v.created_at?new Date(v.created_at).toLocaleDateString():"—"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 text-sm text-gray-700",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-500",children:"Paragraph"}),e.jsx("div",{className:"mt-1 bg-slate-50 p-3 rounded text-sm leading-relaxed whitespace-pre-wrap break-words max-h-60 overflow-auto",children:(v==null?void 0:v.paragraph)??"—"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"font-medium text-slate-500 mb-2",children:"Recent Events"}),e.jsx("div",{className:"w-full bg-white border rounded-lg",children:Ye?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"Loading recent events…"}):U.length===0?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"No recent events."}):e.jsx("div",{className:"max-h-40 overflow-y-auto hide-scrollbar",children:e.jsxs("table",{className:"w-full text-sm divide-y",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Type"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Action"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"User word"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs text-gray-500",children:"Article word"})]})}),e.jsx("tbody",{children:U.map(t=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:t.comparison_type??" "}),e.jsx("td",{className:"px-3 py-2 text-xs",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${t.action==="accept"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.action??" "})}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:t.user_word??" "}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:t.article_word??" "})]},t.id))})]})})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Replaced:"," ",e.jsx("span",{className:"font-medium text-green-700",children:U.filter(t=>t.comparison_type==="replaced"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:U.filter(t=>t.comparison_type==="replaced"&&t.action==="dismiss").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(d)"," "]})]}),e.jsxs("div",{children:["Missing:"," ",e.jsx("span",{className:"font-medium text-green-700",children:U.filter(t=>t.comparison_type==="missing"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:U.filter(t=>t.comparison_type==="missing"&&t.action==="dismiss").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(d)"," "]})]}),e.jsxs("div",{children:["Extra:"," ",e.jsx("span",{className:"font-medium text-green-700",children:U.filter(t=>t.comparison_type==="extra"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:U.filter(t=>t.comparison_type==="extra"&&t.action==="dismiss").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(d)"," "]})]}),e.jsxs("div",{children:["Accuracy:"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Qe?"…":(le==null?void 0:le.accuracy)!=null?`${Number(le.accuracy).toFixed(2)}%`:((ot=v==null?void 0:v._acc)==null?void 0:ot.accuracy)!=null?`${Number(v._acc.accuracy).toFixed(2)}%`:"—"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Avg Pause (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Je?"…":(oe==null?void 0:oe.avg_pause_duration)!=null?Number(oe.avg_pause_duration).toFixed(2):((lt=v==null?void 0:v._acc)==null?void 0:lt.avg_pause_duration)!=null?Number(v._acc.avg_pause_duration).toFixed(2):"—"})]}),e.jsxs("div",{children:["Audio Plays:"," ",e.jsx("span",{className:"font-medium text-blue-700",children:Ue?"…":ze.filter(t=>t.activity_type==="audio_play").length||"0"})]}),e.jsxs("div",{children:["Audio Pauses:"," ",e.jsx("span",{className:"font-medium text-orange-700",children:Ue?"…":ze.filter(t=>t.activity_type==="audio_pause").length||"0"})]}),e.jsxs("div",{children:["Reading Time (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:(v==null?void 0:v.reading_time)??"0"})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>{Y(!1),ve(null)},className:"rounded-[10px] border-2 border-gray-300 px-6 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})}),F&&e.jsx("div",{className:"absolute inset-0 bg-opacity-20 flex items-center justify-center z-10",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8 w-full max-w-xl mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-gray-900 mb-2",children:"Create an account to get started"}),e.jsx("p",{className:"text-gray-600 text-md leading-relaxed font-sans",children:"Create a free SorSer account to start Grammar Checker with AI"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:route("auth.google"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Sign Up with Google"})]}),e.jsxs(ht,{href:route("register"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.jsxs("svg",{className:"w-12 h-12 text-gray-700",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),e.jsx("span",{className:"font-medium text-gray-500",children:"Sign Up by Email"})]})]}),e.jsxs("div",{className:"mt-6 text-md",children:[e.jsx("span",{className:"text-gray-500",children:"Or "}),e.jsx(ht,{href:route("login"),children:e.jsx("span",{className:"text-blue-500 font-medium",children:"Sign In"})})," ","to an existing account"]})]})})})]}),e.jsx(Rt,{}),e.jsx(Ht,{})]})}export{ts as default};
