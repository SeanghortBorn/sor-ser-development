import{r,j as e,S as b,A as j}from"./app-oy554yv7.js";import{A as y}from"./AuthenticatedLayout-JYRYoPe-.js";import"./Dropdown-C7lhyNuS.js";import"./transition-Bc-xVr6w.js";function A({auth:m,articles:d,articleOptions:u}){const[x,p]=r.useState(null),[o,h]=r.useState({}),[c,n]=r.useState(!1),g=async l=>{n(!0),j.put(`/article-settings/${l}`,o[l],{onSuccess:()=>{alert("Settings updated successfully!"),n(!1)},onError:i=>{console.error("Save error:",i),alert("Failed to save settings: "+(i.message||"Unknown error")),n(!1)},onFinish:()=>{n(!1)}})},t=(l,i,a)=>{h(s=>({...s,[l]:{...s[l]||d.find(v=>v.id===l)?.setting||{},[i]:a}}))};return e.jsxs(y,{user:m.user,children:[e.jsx(b,{title:"Article Settings"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Article Progression Settings"}),d.map(l=>{const i=x===l.id,a=o[l.id]||l.setting;return e.jsxs("div",{className:"border rounded-lg mb-4",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50 flex justify-between items-center",onClick:()=>p(i?null:l.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold",children:["#",a?.display_order]}),e.jsx("span",{className:"text-lg",children:l.title}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${a?.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:a?.is_active?"Active":"Inactive"})]}),e.jsx("svg",{className:`w-5 h-5 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"p-6 border-t bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Availability Mode"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:a?.availability_mode||"always",onChange:s=>t(l.id,"availability_mode",s.target.value),children:[e.jsx("option",{value:"always",children:"Always Available"}),e.jsx("option",{value:"sequential",children:"Sequential (After Prerequisite)"}),e.jsx("option",{value:"time_gated",children:"Time Gated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Prerequisite Article"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:a?.prerequisite_article_id||"",onChange:s=>t(l.id,"prerequisite_article_id",s.target.value||null),disabled:a?.availability_mode==="always",children:[e.jsx("option",{value:"",children:"None"}),u.filter(s=>s.id!==l.id).map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Minimum Completion % to Unlock Next"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"1",className:"w-full border rounded px-3 py-2",value:a?.min_completion_percentage??70,onChange:s=>t(l.id,"min_completion_percentage",parseFloat(s.target.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users must achieve this accuracy % to unlock the next article"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Typing Mode"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:a?.typing_mode||"nlp_only",onChange:s=>t(l.id,"typing_mode",s.target.value),children:[e.jsx("option",{value:"none",children:"Adaptive (Based on User Role)"}),e.jsx("option",{value:"nlp_only",children:"NLP Only (Basic Features)"}),e.jsx("option",{value:"nlp_la",children:"NLP+LA (Full Features)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Group A (NLP-only) Redirect After Completion"}),e.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",placeholder:"/homophone-check",value:a?.group_a_redirect||"",onChange:s=>t(l.id,"group_a_redirect",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Where to redirect NLP-only users after completing this article"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Group B (NLP+LA) Redirect After Completion"}),e.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",placeholder:"/users/{id}/progress",value:a?.group_b_redirect||"",onChange:s=>t(l.id,"group_b_redirect",s.target.value)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Where to redirect NLP+LA users (use ","{id}"," for user ID)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Unlock Delay (Days)"}),e.jsx("input",{type:"number",min:"0",className:"w-full border rounded px-3 py-2",value:a?.unlock_delay_days??0,onChange:s=>t(l.id,"unlock_delay_days",parseInt(s.target.value)),disabled:a?.availability_mode!=="time_gated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Unlock Delay (Hours)"}),e.jsx("input",{type:"number",min:"0",max:"23",className:"w-full border rounded px-3 py-2",value:a?.unlock_delay_hours??0,onChange:s=>t(l.id,"unlock_delay_hours",parseInt(s.target.value)),disabled:a?.availability_mode!=="time_gated"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:a?.is_active??!0,onChange:s=>t(l.id,"is_active",s.target.checked)}),e.jsx("span",{className:"text-sm font-medium",children:"Article is Active"})]})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:a?.is_required??!0,onChange:s=>t(l.id,"is_required",s.target.checked)}),e.jsx("span",{className:"text-sm font-medium",children:"Required to Complete"})]})})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>g(l.id),disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:c?"Saving...":"Save Changes"})})]})]},l.id)})]})})})})]})}export{A as default};
