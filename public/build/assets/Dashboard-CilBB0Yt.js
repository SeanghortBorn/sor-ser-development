import{X as L,r as l,j as e,S as U}from"./app-Cisu2Mpw.js";import{A as M}from"./AdminLayout-_pXQNJDa.js";import{B as d}from"./book-open-BikijmoO.js";import{c as P}from"./createLucideIcon-B7QK4j4T.js";import{U as y}from"./users-Bi4Frzww.js";import{C as O}from"./chart-column-CThapPcs.js";import{R as i,T as n,L as c,C as f}from"./CategoricalChart-nMrVRvES.js";import{A as T,a as v}from"./AreaChart-DpJWYCAq.js";import{C as x,X as h,Y as b,L as B,a as N,B as _,b as C}from"./BarChart-C3KdP6ZZ.js";import{P as k,a as w}from"./PieChart-nJv_9tX8.js";import{T as E}from"./trending-up-DFQPjFDe.js";import"./with-selector-Bv9lUhVi.js";import"./defaultLocale-DZ0G4mR_.js";const H=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],g=P("activity",H),te=()=>{const{props:o}=L(),{auth:A,isAdmin:S=!1}=o,t=S||A?.user?.roles?.some(s=>s.name==="Admin"),R=l.useMemo(()=>{const s=o?.stats||{};return t?[{id:"homophones",value:s?.homophones?.count??"—",label:"Total Homophones",trend:s?.homophones?.change??"+0%",icon:d,color:"text-blue-500",borderColor:"border-blue-100",bgColor:"bg-blue-50"},{id:"quizzes",value:s?.quizzes?.count??"—",label:"Quizzes Created",trend:s?.quizzes?.change??"+0%",icon:g,color:"text-green-500",borderColor:"border-green-100",bgColor:"bg-green-50"},{id:"students",value:s?.students?.count??"—",label:"Students Registered",trend:s?.students?.change??"+0%",icon:y,color:"text-orange-500",borderColor:"border-orange-100",bgColor:"bg-orange-50"},{id:"sessions",value:s?.sessions?.count??"—",label:"Student Vs No-Permission",trend:s?.sessions?.change??"+0%",icon:O,color:"text-purple-500",borderColor:"border-purple-100",bgColor:"bg-purple-50"},{id:"activeUsers",value:s?.activeUsers?.count??"—",label:"Active Users (7d)",trend:s?.activeUsers?.change??"+0%",icon:y,color:"text-sky-500",borderColor:"border-sky-100",bgColor:"bg-sky-50"},{id:"avgWords",value:s?.avgWords?.count??"—",label:"Avg Words/Check (7d)",trend:s?.avgWords?.change??"+0%",icon:g,color:"text-emerald-500",borderColor:"border-emerald-100",bgColor:"bg-emerald-50"}]:[{id:"completed",value:s?.articles_completed??"0",label:"Articles Completed",trend:"+0%",icon:d,color:"text-blue-500",borderColor:"border-blue-100",bgColor:"bg-blue-50"},{id:"total",value:s?.total_articles??"0",label:"Total Articles",trend:"+0%",icon:d,color:"text-green-500",borderColor:"border-green-100",bgColor:"bg-green-50"},{id:"rate",value:`${s?.completion_rate??"0"}%`,label:"Completion Rate",trend:"+0%",icon:g,color:"text-purple-500",borderColor:"border-purple-100",bgColor:"bg-purple-50"}]},[o?.stats,t]),z=l.useMemo(()=>t?o?.weeklyData??[]:[],[o?.weeklyData,t]),p=["#3b82f6","#10b981","#f59e0b","#8b5cf6","#ef4444","#06b6d4"],u=l.useMemo(()=>(o?.topArticles??[]).map((r,$)=>({name:r.name,value:r.attempts??r.value??0,color:p[$%p.length]})),[o?.topArticles]),a=o?.comparison||{},D=l.useMemo(()=>t?a.trend7d||[]:[],[a.trend7d,t]),j=l.useMemo(()=>t?(a.distribution||[]).map((s,r)=>({...s,color:r===0?"#2563eb":"#f97316"})):[],[a.distribution,t]),W=l.useMemo(()=>{if(!t)return[];const s=a?.avgWordPerCheck||{},r=a?.avgChecksPerUser||{};return[{metric:"Avg Words/Check",Student:Number(s.student??0),"No Role":Number(s.norole??0)},{metric:"Avg Checks/User",Student:Number(r.student??0),"No Role":Number(r.norole??0)}]},[a?.avgWordPerCheck,a?.avgChecksPerUser,t]),m=l.useMemo(()=>o?.recentActivity??[],[o?.recentActivity]),K=({stat:s})=>{const r=s.icon;return e.jsxs("div",{className:`bg-white px-3 pb-2 pt-3 border-l-4 ${s.borderColor} shadow-sm rounded-xl flex flex-col hover:shadow-md transition-shadow duration-200`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-800 text-sm font-semibold",children:s.label}),e.jsx("div",{className:`${s.color}`,children:e.jsx(r,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsxs("p",{className:"text-xs text-green-600 font-medium mt-1 flex items-center",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),s.trend," vs last month"]})]})]})};return e.jsxs(M,{children:[e.jsx(U,{title:"Dashboard"}),e.jsxs("div",{className:"bg-gray-50 min-h-screen p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t?"Admin Dashboard":"My Dashboard"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:t?"Welcome back! Here's your homophone learning analytics.":"Welcome back! Here's your personal learning progress."})]}),e.jsx("div",{className:`grid grid-cols-1 ${t?"md:grid-cols-2 lg:grid-cols-3":"md:grid-cols-3"} gap-4 mb-6`,children:R.map(s=>e.jsx(K,{stat:s},s.id))}),t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Activity Overview"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Sessions and engagement last 7 days"})]}),e.jsx(i,{width:"100%",height:300,children:e.jsxs(T,{data:z,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorSessions",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorEngagement",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(x,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"day",stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(b,{stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"12px"}}),e.jsx(c,{wrapperStyle:{fontSize:"12px"}}),e.jsx(v,{type:"monotone",dataKey:"sessions",stroke:"#3b82f6",fillOpacity:1,fill:"url(#colorSessions)"}),e.jsx(v,{type:"monotone",dataKey:"engagement",stroke:"#10b981",fillOpacity:1,fill:"url(#colorEngagement)"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Top Articles"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"By checks"})]}),e.jsx(i,{width:"100%",height:300,children:e.jsxs(k,{children:[e.jsx(w,{data:u,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:r})=>`${s.split("/")[0]}: ${r}`,outerRadius:80,fill:"#8884d8",dataKey:"value",style:{fontSize:"11px"},children:u.map((s,r)=>e.jsx(f,{fill:s.color},`cell-${r}`))}),e.jsx(n,{formatter:s=>`${s} checks`,contentStyle:{fontSize:"12px",borderRadius:"8px",border:"1px solid #e5e7eb"}})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Engagement Trend (7d)"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Student vs No-Role checks"})]}),e.jsx(i,{width:"100%",height:280,children:e.jsxs(B,{data:D,margin:{top:5,right:30,left:0,bottom:5},children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"day",stroke:"#9ca3af"}),e.jsx(b,{stroke:"#9ca3af"}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(c,{}),e.jsx(N,{type:"monotone",dataKey:"student",stroke:"#2563eb",strokeWidth:2,dot:{r:3},name:"Student"}),e.jsx(N,{type:"monotone",dataKey:"norole",stroke:"#f97316",strokeWidth:2,dot:{r:3},name:"No Role"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Checks Distribution"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Share of checks by group"})]}),e.jsx(i,{width:"100%",height:280,children:e.jsxs(k,{children:[e.jsx(w,{data:j,cx:"50%",cy:"50%",outerRadius:90,dataKey:"value",labelLine:!1,label:({name:s,value:r})=>`${s}: ${r}`,children:j.map((s,r)=>e.jsx(f,{fill:s.color},`cmp-${r}`))}),e.jsx(n,{formatter:(s,r)=>[`${s}`,r]}),e.jsx(c,{})]})})]})]}),e.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"KPI Comparison"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Student vs No-Role on Avg Words/Check and Avg Checks/User"})]}),e.jsx(i,{width:"100%",height:320,children:e.jsxs(_,{data:W,margin:{top:5,right:20,left:0,bottom:5},children:[e.jsx(x,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"metric",stroke:"#9ca3af"}),e.jsx(b,{stroke:"#9ca3af"}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(c,{}),e.jsx(C,{dataKey:"Student",fill:"#2563eb",radius:[4,4,0,0]}),e.jsx(C,{dataKey:"No Role",fill:"#f97316",radius:[4,4,0,0]})]})})]})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"My Recent Activity"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Your learning progress"})]}),e.jsx("div",{className:"space-y-3",children:m&&m.length>0?m.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(d,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.article?.title||"Article"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Completed on ",new Date(s.completed_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"text-green-600 font-semibold",children:"✓ Completed"})]},r)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No activity yet. Start learning!"})]})})]})]})]})};export{te as default};
