import{r as i,j as e,S as F,x as L,A as N}from"./app-AW0S6vsN.js";import{A as M}from"./AdminLayout-B0vyzGU9.js";import{B as R}from"./Breadcrumb-DORZLxZn.js";function E({datas:l,isEdit:o}){const u=o?"Edit Article":"Create Article",[n,c]=i.useState({title:l?.title??"",file:null,audio:null}),[C,x]=i.useState(null),[h,p]=i.useState(null),[v,j]=i.useState(!1),[a,m]=i.useState({}),f=i.useRef(null),g=i.useRef(null);i.useEffect(()=>{l&&(c({title:l.title||"",file:null,audio:null}),x(l.file?y(l.file,"files"):null),p(l.audio?y(l.audio,"audios"):null))},[l]);const y=(t,s)=>{if(!t)return null;if(typeof t=="string")return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("/storage/")?t:`/storage/uploads/${s}/${t}`;if(t.file_path){const r=String(t.file_path);return r.startsWith("http://")||r.startsWith("https://")||r.startsWith("/storage/")?r:r.startsWith("storage/")?`/${r}`:r.startsWith("uploads/")?`/storage/${r}`:r.startsWith("public/")?`/storage/${r.replace(/^public\//,"")}`:`/storage/uploads/${s}/${r}`}if(t.url)return t.url;if(t.path){const r=t.path.replace(/^public\//,"");return t.path.startsWith("http")||t.path.startsWith("/")?t.path:`/storage/${r}`}return t.filename?`/storage/uploads/${s}/${t.filename}`:t.name?`/storage/uploads/${s}/${t.name}`:null},w=t=>t?typeof t=="string"?t.split("/").pop():t.title||t.filename||t.name||null:null,A=t=>{const{name:s,value:r}=t.target;c({...n,[s]:r})},k=t=>{const s=t.target.files[0];c({...n,file:s||null}),x(s?URL.createObjectURL(s):null)},S=t=>{const s=t.target.files[0];c({...n,audio:s||null}),p(s?URL.createObjectURL(s):null)},W=t=>{t.preventDefault(),j(!0),m({});const s={...n},r=new FormData;r.append("title",s.title??""),s.file&&r.append("file",s.file),s.audio&&r.append("audio",s.audio);const d=()=>j(!1);o?(r.append("_method","PATCH"),N.post(route("articles.update",l.id),r,{forceFormData:!0,onFinish:d,onError:b=>{m(b||{}),d()}})):N.post(route("articles.store"),r,{forceFormData:!0,onFinish:d,onError:b=>{m(b||{}),d()}})},$=[{title:"Home",url:"/"},{title:u,url:""}];return e.jsxs(M,{breadcrumb:e.jsx(R,{header:u,links:$}),children:[e.jsx(F,{title:u}),e.jsx("div",{className:"bg-gradient-to-br from-slate-50 to-blue-50/30 mb-12",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"border-b mb-3",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:o?"Edit Article":"Create New Article"}),e.jsx("p",{className:"text-sm text-gray-500",children:o?"Update the details of this article below.":"Fill out the form below to create a new article."})]}),e.jsxs("form",{onSubmit:W,className:"space-y-4",encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title"}),e.jsx("input",{name:"title",type:"text",value:n.title,onChange:A,className:`w-full border rounded-md px-3 py-2 ${a.title?"border-red-500":""}`,placeholder:"Enter article title"}),a.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Select File ",e.jsx("span",{children:" "})]}),e.jsxs("div",{className:"flex items-center justify-center h-32 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 cursor-pointer relative bg-gray-50 hover:bg-blue-50 transition",onClick:()=>{f.current&&f.current.click()},style:{minHeight:100},children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.txt",ref:f,onChange:k,className:"absolute inset-0 opacity-0 cursor-pointer",tabIndex:-1,style:{pointerEvents:"auto"},onClick:t=>t.stopPropagation()}),e.jsxs("div",{className:"text-center space-y-2 pointer-events-none",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-8 w-8 text-gray-400 pointer-events-none",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 16a1 1 0 0 1-1-1V9.414L8.707 11.707a1 1 0 1 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L13 9.414V15a1 1 0 0 1-1 1z"}),e.jsx("path",{d:"M4 18a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1z"})]}),e.jsx("div",{className:"text-sm text-gray-500 pointer-events-none",children:"Select a file or drag here"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition pointer-events-none",children:n.file?"Change file":"Select a file"})]})]}),a.file&&e.jsx("div",{className:"text-red-600 mt-2 text-sm",children:a.file}),C&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border rounded-xl p-3 mt-3 hover:bg-gray-100 transition",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg flex items-center justify-center text-green-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-file-json2-icon lucide-file-json-2",children:[e.jsx("path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}),e.jsx("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),e.jsx("path",{d:"M4 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1"}),e.jsx("path",{d:"M8 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1"})]})}),e.jsx("div",{className:"flex items-center mt-2 space-x-2 justify-center",children:e.jsx("p",{className:"text-sm font-medium text-gray-800",children:n.file?n.file.name:w(l?.file)||"Download"})})]}),e.jsx("button",{onClick:()=>x(null),className:"ml-4 text-gray-400 hover:text-gray-600 flex items-center justify-center",children:"✕"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Upload Audio ",e.jsx("span",{})]}),e.jsxs("div",{className:"flex items-center justify-center h-32 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 cursor-pointer relative bg-gray-50 hover:bg-blue-50 transition",onClick:()=>{g.current&&g.current.click()},style:{minHeight:100},children:[e.jsx("input",{type:"file",accept:"audio/*",ref:g,onChange:S,className:"absolute inset-0 opacity-0 cursor-pointer",tabIndex:-1,style:{pointerEvents:"auto"},onClick:t=>t.stopPropagation()}),e.jsxs("div",{className:"text-center space-y-2 pointer-events-none",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-8 w-8 text-gray-400 pointer-events-none",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 16a1 1 0 0 1-1-1V9.414L8.707 11.707a1 1 0 1 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L13 9.414V15a1 1 0 0 1-1 1z"}),e.jsx("path",{d:"M4 18a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1z"})]}),e.jsx("div",{className:"text-sm text-gray-500 pointer-events-none",children:"Select an audio file or drag here"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition pointer-events-none",children:n.audio?"Change Audio":"Select Audio"})]})]}),a.audio&&e.jsx("div",{className:"text-red-600 mt-2 text-sm",children:a.audio}),h&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border rounded-xl p-3 mt-3 hover:bg-gray-100 transition",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg flex items-center justify-center text-blue-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]})}),e.jsxs("div",{className:"flex items-center justify-between w-full space-x-4 mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:n.audio?.name||w(l?.audio)||"Play Audio"}),e.jsx("audio",{src:h,controls:!0,preload:"metadata",className:"w-96 border rounded-3xl"},h)]})]}),e.jsx("button",{onClick:()=>p(null),className:"ml-4 text-gray-400 hover:text-gray-600 flex items-center justify-center",children:"✕"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row sm:justify-end gap-3 pt-6 mt-6 border-t border-gray-200",children:[e.jsx(L,{href:route("articles.index"),className:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-[10px] text-gray-600 border-2 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition duration-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center justify-center px-8 py-2 text-sm font-medium rounded-[10px] text-white bg-gradient-to-r from-blue-500 to-blue-500 transition duration-200 hover:from-blue-500 hover:to-blue-600",disabled:v,children:v?o?"Updating...":"Saving...":o?"Update Article":"Create Article"})]})]})]})})})]})}export{E as default};
