import{G as A,r as g,j as e,S as L,x as z}from"./app-BjqCgIyx.js";import{B as F}from"./Breadcrumb-CypNNXXb.js";import{I as j}from"./InputError-FSW--TRd.js";import{A as P}from"./AdminLayout-B7XET_EX.js";function W({role:i,permissions:v}){const{data:l,setData:c,post:y,patch:N,errors:d,reset:p,processing:f}=A({name:(i==null?void 0:i.name)||"",permissions:[]}),[x,w]=g.useState("");g.useEffect(()=>{if(i!==void 0){const s=i.permissions.map(t=>t.id);c("permissions",s)}},[i]);const k=s=>{const t=parseInt(s.target.value);s.target.checked?l.permissions.includes(t)||c("permissions",[...l.permissions,t]):c("permissions",l.permissions.filter(a=>a!==t))},C=(s,t)=>{const a=t.map(r=>r.id);if(a.every(r=>l.permissions.includes(r)))c("permissions",l.permissions.filter(r=>!a.includes(r)));else{const r=[...l.permissions];a.forEach(n=>{r.includes(n)||r.push(n)}),c("permissions",r)}},S=s=>{s.preventDefault(),i==null?y(route("roles.store"),{preserveState:!0,onFinish:()=>p()}):N(route("roles.update",i.id),{preserveState:!0,onFinish:()=>p()})},u=s=>s.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "),h=(()=>{const s={};return v.forEach(t=>{const a=t.name.split("-"),o=["list","create","edit","delete","export","import","view","manage"];let r,n;const b=a[a.length-1];o.includes(b)?(n=b,r=a.slice(0,-1).join("-")):(r=a[0],n=a.slice(1).join("-")),s[r]||(s[r]=[]),s[r].push({...t,action:n,displayAction:u(n)})}),Object.keys(s).forEach(t=>{s[t].sort((a,o)=>{const r=["list","view","create","edit","delete"];return r.indexOf(a.action)-r.indexOf(o.action)})}),s})(),E=Object.keys(h).filter(s=>s.toLowerCase().includes(x.toLowerCase())||h[s].some(t=>t.displayAction.toLowerCase().includes(x.toLowerCase()))),m=i!=null&&i.id?"Edit Role":"Create Role",R=[{title:"Home",url:"/"},{title:"Roles",url:route("roles.index")},{title:m,url:""}];return e.jsxs(P,{breadcrumb:e.jsx(F,{header:m,links:R}),children:[e.jsx(L,{title:m}),e.jsx("section",{className:"content",children:e.jsx("div",{className:"container-fluid sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-gradient-to-br from-slate-50 to-blue-50/30 mb-12",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:m}),e.jsx("p",{className:"text-gray-500",children:i!=null&&i.id?"Update role details and permissions":"Create a new role and assign permissions"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Role Name"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"name",name:"name",type:"text",placeholder:"Enter role name",value:l.name,onChange:s=>c("name",s.target.value),className:`block mt-2 w-full px-3 py-[11px] text-sm rounded-xl border ${d.name?"border-red-300 focus:ring-red-200 focus:border-red-400":"border-gray-300 focus:ring-blue-200 focus:border-blue-400"} placeholder-gray-400 shadow-sm focus:outline-none focus:ring-2`}),d.name&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),e.jsx(j,{message:d.name,className:"mt-1 text-sm text-red-600"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"permissions",className:"block text-sm font-medium text-gray-700 mb-1",children:["Permissions"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{className:"relative w-full max-w-xs",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search modules or permissions"}),e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{id:"search",type:"text",placeholder:"Search modules...",value:x,onChange:s=>w(s.target.value),className:"pl-10 pr-16 py-2 border border-gray-300 rounded-xl focus:ring-0 w-full"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:E.map(s=>{const t=h[s],a=t.filter(n=>l.permissions.includes(n.id)).length,o=a===t.length,r=a>0&&a<t.length;return e.jsxs("div",{className:"bg-white border border-blue-100 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-4 border-b border-blue-100 bg-gradient-to-r from-blue-50 to-blue-50 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-blue-700 capitalize flex items-center",children:u(s)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${o?"bg-blue-100 text-blue-800":r?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600"}`,children:[a,"/",t.length]}),e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,ref:n=>{n&&(n.indeterminate=r)},onChange:()=>C(s,t),className:"form-checkbox mt-2 h-4 w-4 text-blue-500 rounded border-gray-300 focus:ring-blue-500 focus:ring-1"}),e.jsx("span",{className:"ml-2 mt-2 text-xs text-gray-600",children:"All"})]})]})]})}),e.jsx("div",{className:"p-3",children:t.map(n=>e.jsxs("label",{className:"flex items-center space-x-4 cursor-pointer group hover:bg-blue-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",value:n.id,checked:l.permissions.includes(n.id),onChange:k,className:"form-checkbox h-4 w-4 text-blue-500 rounded border-gray-300 focus:ring-1 focus:ring-blue-500"}),e.jsx("div",{className:"flex items-center space-x-2 flex-1",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[u(s)," ",n.displayAction]})})]},n.id))})]},s)})}),e.jsx(j,{className:"mt-4 text-sm text-red-600",message:d.permissions})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row sm:justify-end gap-3 pt-6 mt-6 border-t border-gray-200",children:[e.jsxs(z,{href:route("roles.index"),className:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-xl text-gray-700 border hover:bg-gray-200 hover:border-gray-400 hover:text-gray-900 transition duration-200",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Cancel"]}),e.jsx("button",{type:"submit",disabled:f,className:"inline-flex items-center justify-center px-6 py-2 text-sm font-medium rounded-xl text-white bg-gradient-to-r from-blue-500 to-blue-500 shadow-sm transition duration-200 hover:from-blue-500 hover:to-blue-500 disabled:opacity-70 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i!=null&&i.id?"Updating...":"Saving..."]}):e.jsx(e.Fragment,{children:i!=null&&i.id?"Update Role":"Save Role"})})]})]})]})})})})})]})}export{W as default};
