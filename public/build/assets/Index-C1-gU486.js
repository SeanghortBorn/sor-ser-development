import{X as ze,j as e,r,R as Et,a as y,S as $t,x as ct}from"./app-BlP1oyqg.js";import{H as Ht}from"./HeaderNavbar-DvaUK0Es.js";import{F as Lt}from"./Footer-G9S0LDMS.js";import{B as Ft,Z as It,R as Pt}from"./zap--pYVb7MQ.js";import{M as ue}from"./Modal-DAFCMiRc.js";import{c as Ue}from"./createLucideIcon-BHE0qHjX.js";import{R as ot,C as lt,T as dt,L as ut}from"./CategoricalChart-CGbIxJfL.js";import{P as mt,a as xt}from"./PieChart-awukXLHm.js";import"./transition-BJRBwuAD.js";import"./with-selector-BsJARvNf.js";import"./defaultLocale-DZ0G4mR_.js";const Wt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Bt=Ue("arrow-right",Wt);const zt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ht=Ue("check",zt);const Ut=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Vt=Ue("trash",Ut);function Rt(){const{auth:k}=ze().props;return e.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-10",children:k.user?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-center ",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-semibold text-gray-600",children:["Triple your productivity with the"," ",e.jsx("span",{className:"text-blue-500 font-semibold",children:"Homophone Checker"})]}),e.jsx("p",{className:"text-gray-600 mt-4 max-w-6xl mx-auto",children:"SorSer's Homophone Checker uses AI to instantly fix grammar, spelling, and punctuation mistakes. Start typing, and the AI will detect and correct errors in real time, making your writing clear, accurate, and polished."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-9",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-semibold text-gray-600",children:["Triple your productivity with the"," ",e.jsx("span",{className:"text-blue-500 font-semibold",children:"Homophone Checker"})]}),e.jsx("p",{className:"text-gray-600 mt-4 max-w-6xl mx-auto",children:"SorSer's Homophone Checker uses AI to instantly fix grammar, spelling, and punctuation mistakes. Start typing, and the AI will detect and correct errors in real time, making your writing clear, accurate, and polished."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ft,{className:"text-pink-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"How To Use SorSer Tool"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"SorSer's AI helps you write better by detecting and fixing grammar, spelling, and punctuation mistakes as you type. It works in real time, so you can focus on your ideas while the AI takes care of corrections."}),e.jsxs("div",{className:"bg-white border rounded-xl p-3",children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Sample Grammar Checker"}),e.jsxs("div",{className:"mt-1 p-3 rounded-xl border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-800 mb-1",children:"Typing Your Sentence:"}),e.jsx("div",{className:"text-gray-600 text-sm mb-2",children:"What key difference distinguishes isotopes from one another?"}),e.jsxs("ul",{className:"mt-2 text-sm text-gray-700 space-y-2",children:[e.jsxs("li",{children:["•"," ",e.jsx("span",{className:"underline decoration-red-500 decoration-2 underline-offset-4",children:"She go"})," ","to the office every morning."]}),e.jsxs("li",{children:["•"," ",e.jsxs("span",{className:"underline decoration-green-500 decoration-2 underline-offset-4",children:["She ",e.jsx("strong",{children:"goes"})]})," ","to the office every morning."]})]})]})]})]}),e.jsxs("div",{className:"space-y-9",children:[e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(It,{className:"text-orange-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Lightning Fast"})]}),e.jsx("p",{className:"text-gray-600",children:"Boost your writing speed with AI-powered grammar checking that instantly detects and fixes errors. SorSer helps you turn rough drafts into clear, polished text in seconds — no extra effort required"})]}),e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Pt,{className:"text-pink-500",size:28}),e.jsx("h2",{className:"text-xl font-semibold text-gray-600",children:"Features for Everyone"})]}),e.jsxs("p",{className:"text-gray-600",children:["Whether you're a student, teacher, or professional, SorSer makes writing easier and more accurate."," ",e.jsx("span",{className:"text-blue-600 cursor-pointer hover:underline",children:"Try it out"})," ","to experience real-time grammar, spelling, and punctuation checking that helps you write with confidence."]})]})]})]})]})})}function Gt(){return e.jsx("div",{className:"w-full max-w-7xl mx-auto text-left py-8 pl-2",children:e.jsxs("div",{className:"flex justify-between items-center text-md",children:[e.jsxs("span",{className:"text-gray-500 text-md",children:["Try it out above by using ",e.jsx("span",{className:"font-semibold",children:"handwritten notes."})]}),e.jsxs("span",{className:"text-gray-500 text-md",children:["Don't have any content? ","",e.jsx("button",{className:"text-blue-500 text-md hover:underline",children:"Create from scratch"})]})]})})}function Ot({text:k="",onReplace:N,checkerId:L,comparisonResult:j,setComparisonResult:q,articleId:C,isChecking:B=!1}){const[K,Q]=r.useState([]),[R,me]=r.useState(!1),[ee,P]=r.useState(!1),[g,E]=r.useState(null),[X,T]=r.useState(null),[xe,$]=r.useState(null),[_e,pt]=r.useState(""),[Ae,Se]=r.useState("idle"),[he,ke]=r.useState(null),[Ce,Te]=r.useState(0),[pe,Ve]=r.useState([]),[De,Me]=r.useState(""),[fe,Re]=r.useState(null),[te,Ee]=r.useState(!1),[z,ge]=r.useState(null),[se,Z]=r.useState(null),[ye,ae]=r.useState(!1),re=ze(),{auth:F}=re.props||{},[H,$e]=r.useState(null),[ie,W]=r.useState(null),He=i=>{if(i===0||!j)return;const o=j.comparison.filter(n=>n.type==="missing"||n.type==="replaced"||n.type==="extra");if(i>=o.length)return;const a=[o[i],...o.slice(0,i),...o.slice(i+1)],l=j.comparison.filter(n=>n.type!=="missing"&&n.type!=="replaced"&&n.type!=="extra"),p=[...a,...l];q({...j,comparison:p})},S=(i,o,d=!1)=>{if(!i||!N||!j)return;y.post("/api/track/comparison-action",{grammar_checker_id:L,article_id:C??null,action:o,comparison_type:i.type,user_word:i.user_word?.user_word||"",article_word:i.article_word?.article_word||"",word_position:i.user_word?.user_index||i.article_word?.article_index,session_id:sessionStorage.getItem("sessionId")}).catch(x=>console.error("Track comparison action error:",x));let a=[...j.comparison],l=[...j.user_words];const p=a.findIndex(x=>x===i);if(p===-1)return;if(o==="dismiss"){const x=`${i.type}-${i.user_word?.user_index||"none"}-${i.article_word?.article_index||"none"}`;Q(_=>[..._,x]),a=a.filter((_,M)=>M!==p)}else if(o==="accept"){if(i.type==="missing"){const x=i.article_word.article_index;l.splice(x,0,i.actions.accept.result)}else if(i.type==="extra"){const x=i.user_word.user_index;typeof x=="number"&&l.splice(x,1)}else if(i.type==="replaced"){const x=i.user_word.user_index;typeof x=="number"&&(l[x]=i.actions.accept.result)}a=a.filter((x,_)=>_!==p)}if(a.filter(x=>x.type==="missing"||x.type==="replaced"||x.type==="extra").length===0&&!d){try{ge(G({...j,comparison:a,user_words:l}))}catch{}K.length===0&&(l=[...j.article_words]),setTimeout(()=>{q(null),Q([])},500)}else q({...j,comparison:a,user_words:l});if(!d){const x=l.join("");N(x)}},je=async()=>{if(!j)return;const i=j.comparison.filter(n=>n.type==="missing"||n.type==="replaced"||n.type==="extra"),o=Math.max(...j.comparison.filter(n=>n.type==="same"||n.type==="replaced"||n.type==="extra").map(n=>n.index_compared),-1),d=i.filter(n=>n.type!=="missing"||n.index_compared<=o),a=[],l=[];for(const n of j.comparison){if(n.type==="same"){const M=n.article_word?.article_word||n.user_word?.user_word||"";M!==""&&a.push(M);continue}if(!d.includes(n))continue;if(n.type==="extra"){l.push({action:"accept",comparison_type:n.type,user_word:n.user_word?.user_word||"",article_word:n.article_word?.article_word||"",word_position:n.user_word?.user_index||n.article_word?.article_index});continue}n.type==="missing"&&l.push({action:"accept",comparison_type:n.type,user_word:n.user_word?.user_word||"",article_word:n.article_word?.article_word||"",word_position:n.user_word?.user_index||n.article_word?.article_index}),n.type==="replaced"&&l.push({action:"accept",comparison_type:n.type,user_word:n.user_word?.user_word||"",article_word:n.article_word?.article_word||"",word_position:n.user_word?.user_index||n.article_word?.article_index});const _=n.actions&&n.actions.accept&&n.actions.accept.result||n.article_word?.article_word||n.user_word?.user_word||"";_!==""&&a.push(_)}for(const n of l)try{await y.post("/api/track/comparison-action",{grammar_checker_id:L,article_id:C??null,action:n.action,comparison_type:n.comparison_type,user_word:n.user_word,article_word:n.article_word,word_position:n.word_position,session_id:sessionStorage.getItem("sessionId")})}catch(x){console.error("Track comparison action error:",x.response?.data??x.message)}const p=a.join("");N(p),q(null),Q([])},b=i=>i?i.normalize("NFD").replace(/[\u17BB-\u17D2]/g,"").replace(/\s+/g,"").toLowerCase():"",be=async()=>{if(X)return X;P(!0);const i=["/homophones.json","/storage/homophones.json","/homophones/json"];let o=[];for(const a of i)try{const l=await y.get(a,{headers:{Accept:"application/json"}});if(o=l.data?.homophones??l.data?.data??(Array.isArray(l.data)?l.data:null)??(Array.isArray(Object.values(l.data))?Object.values(l.data):[]),o.length)break}catch{}const d={};return o.forEach(a=>{const l=a.word?.trim(),p=b(l);l&&(d[l]=a),p&&(d[p]=a)}),T(d),P(!1),d},ne=async(i,o=null)=>{if(!i)return;$e(o),W(i),E(null),me(!0),P(!0);const d=i.article_word&&i.article_word.article_word||i.user_word&&i.user_word.user_word||"";if(!d){E({word:"",notFound:!0}),P(!1);return}try{const a=await be();if(a[d]){E({...a[d],displayedWord:d}),P(!1);return}const l=b(d),p=l?a[l]:null;if(p){const x=(Array.isArray(p.homophone)?p.homophone:[]).includes(d);E(x?{...p,displayedWord:d,isHomophone:!0}:{word:d,notFound:!0})}else E({word:d,notFound:!0})}catch{E({word:d,notFound:!0})}finally{P(!1)}},D=()=>{me(!1),E(null),$e(null),W(null)},ce=()=>{ie&&H&&S(ie,H),D()},oe=(i,o)=>{F?.can?.student===!0?ne(i,o):S(i,o)},G=i=>{if(!i||!Array.isArray(i.comparison))return{replaced:0,extra:0,missing:0,same:0,total:0,accuracy:null,avgPause:null};const o=i.comparison,d=o.filter(A=>A.type==="replaced").length,a=o.filter(A=>A.type==="extra").length,l=o.filter(A=>A.type==="missing").length,p=o.filter(A=>A.type==="same").length,n=Array.isArray(i.article_words)?i.article_words.length:o.length,x=n>0?Math.round(p/n*1e4)/100:null;let _=i.metadata?.avg_pause_duration??i.metadata?.avgPause??null;const M=_!=null&&!Number.isNaN(Number(_))?Math.round(Number(_)*100)/100:null;return{replaced:d,extra:a,missing:l,same:p,total:n,accuracy:x,avgPause:M}};r.useEffect(()=>{j&&ge(G(j))},[j]);const[Ge,ve]=r.useState(null),[Le,f]=r.useState(!1);async function Fe(i){if(!i||!i.trim())return null;const o=["/api/khmer-segment"];for(const d of o)try{const a=await y.post(d,{text:i},{headers:{"Content-Type":"application/json"}}),l=a.data?.tokens??a.data?.data?.tokens??(Array.isArray(a.data)?a.data:null);if(Array.isArray(l))return l}catch{}return null}const U=i=>{const o=String(i||"").trim(),d=o.length,a=o?o.split(/\s+/).filter(Boolean).length:0,l=o?o.split(/[.!?]+/).map(A=>A.trim()).filter(Boolean).length:0,p=o?o.split(/\n+/).map(A=>A.trim()).filter(Boolean).length:0,n=a>0?Math.ceil(a/200*60):0,x=Math.floor(n/60),_=n%60,M=`${x} m ${_} s`;return{characters:d,words:a,sentences:l,paragraphs:p,readingTime:M,readingSeconds:n}};async function J(i){const o=String(i||"").trim();if(!o)return U(o);try{const d=await Fe(o),a=Array.isArray(d)?d.length:o.split(/\s+/).filter(Boolean).length,l=o.length,p=o?o.split(/[.!?]+/).map(de=>de.trim()).filter(Boolean).length:0,n=o?o.split(/\n+/).map(de=>de.trim()).filter(Boolean).length:0,x=a>0?Math.ceil(a/200*60):0,_=Math.floor(x/60),M=x%60,A=`${_} m ${M} s`;return{characters:l,words:a,sentences:p,paragraphs:n,readingTime:A,readingSeconds:x}}catch(d){return console.error("Khmer segmentation error:",d),U(o)}}const[le,h]=r.useState(!1),I=Et.useRef(null),O=async(i={})=>{const o=z??G(j);if(!o||o.total===0||!L&&!C)return null;const d=await J(k),a={grammar_checker_id:L??null,article_id:C??null,accuracy:o.accuracy??null,replaced_count:o.replaced??0,extra_count:o.extra??0,missing_count:o.missing??0,avg_pause_duration:se?.avg_pause_duration??o.avgPause??null,user_word_count:d.words??null,article_total_words:o.total??null,reading_time_seconds:d.readingSeconds??null};if(a.avg_pause_duration===null)try{const l=await V();l&&typeof l.avg_pause_duration=="number"&&(a.avg_pause_duration=Number(l.avg_pause_duration))}catch{}if(le)return null;h(!0);try{return await y.post("/api/accuracy",a,{headers:{Accept:"application/json"},withCredentials:!0}),!0}catch(l){return console.error("Save accuracy error:",l?.response?.data??l),null}finally{h(!1)}},we=()=>{I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{O().catch(()=>{})},700)};r.useEffect(()=>{const i=z??G(j);if(!(!i||i.total===0)&&!(!L&&!C))return we(),()=>{I.current&&(clearTimeout(I.current),I.current=null)}},[z,j,k,L,C]),r.useEffect(()=>{if(!te)return;V(L).catch(()=>{});let i=!1;return f(!0),ve(null),J(k).then(o=>{i||ve(o)}).catch(()=>{}).finally(()=>{i||f(!1)}),()=>{i=!0}},[te,z]);async function V(i=null){ae(!0),Z(null);const o=["/api/user-activity-stats","/api/user-activities/stats","/api/track/stats","/user-activity-stats"],d=typeof sessionStorage<"u"?sessionStorage.getItem("sessionId"):null;for(const a of o)try{const l={};d&&(l.session_id=d),i&&(l.grammar_checker_id=i),C&&(l.article_id=C);const p=await y.get(a,{params:l,headers:{Accept:"application/json"}}),n=p.data?.data??p.data??null;if(n&&typeof n=="object")return Z(n),ae(!1),n}catch{}return ae(!1),null}if(j){const i=j.comparison.filter(a=>a.type==="missing"||a.type==="replaced"||a.type==="extra"),o=Math.max(...j.comparison.filter(a=>a.type==="same"||a.type==="replaced"||a.type==="extra").map(a=>a.index_compared),-1),d=i.filter(a=>a.type!=="missing"||a.index_compared<=o);return e.jsxs("div",{className:"w-96 rounded-xl border border-gray-200 bg-white h-[75vh] flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 pt-4 pb-2 border-gray-200",children:[B?e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm animate-pulse mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}):e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"text-gray-800 text-base font-semibold",children:"Comparison Results"})}),B?e.jsxs("div",{className:"flex items-center space-x-2 animate-pulse mb-1",children:[e.jsx("div",{className:"h-8 w-20 bg-slate-200 rounded-lg"}),e.jsx("div",{className:"h-8 w-28 bg-slate-200 rounded-lg"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"text-sm text-blue-900 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["All"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:d.length})]}),e.jsxs("button",{className:"text-sm text-green-600 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["Differences"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:d.length})]})]}),e.jsx("div",{className:"border-b"})]}),e.jsx("div",{className:"space-y-2 px-4 py-0 mb-2 flex-1 overflow-y-auto hide-scrollbar",children:B?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}),[...Array(3)].map((a,l)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"h-3 w-24 bg-slate-200 rounded mb-3"}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("div",{className:"h-4 w-16 bg-slate-300 rounded"}),e.jsx("div",{className:"h-4 w-20 bg-slate-200 rounded"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"})]})]},l))]}):e.jsxs(e.Fragment,{children:[d.length>0&&e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsxs("span",{className:"text-red-500 text-sm font-semibold",children:[d.length," ","differences"]}),e.jsx("span",{className:"text-gray-600 text-sm ml-1",children:"found"})]}),e.jsx("button",{className:"border border-green-500 text-green-600 px-3 py-1 rounded-full text-xs font-medium hover:bg-green-50 transition",onClick:je,children:"Accept all"})]}),d.map((a,l)=>e.jsxs("div",{onClick:()=>He(l),className:`bg-white rounded-xl p-3 border shadow-sm cursor-pointer transition ${l===0?"border-blue-500 border-2":"border-gray-200"}`,children:[e.jsxs("p",{className:"text-xs text-gray-500 font-medium mb-2",children:[a.type==="missing"&&"Missing Word (Expected word is missing)",a.type==="replaced"&&"Incorrect Word",a.type==="extra"&&"Extra Word (Unmatched in the article)"]}),e.jsxs("div",{className:`${a.type!=="missing"?"gap-2 ":""} mb-3 flex items-center `,children:[e.jsx("span",{className:`${a.type!=="missing"?"line-through ":""}text-base ${l===0?"text-red-500":"text-gray-500"}`,children:typeof a.user_word?.user_word=="string"&&a.user_word.user_word!==""?a.user_word.user_word:""}),e.jsx("span",{children:a.type!=="missing"&&e.jsx(Bt,{className:"w-4 h-4 text-slate-500"})}),e.jsx("span",{className:`text-base font-semibold ${l===0?"text-green-600":"text-green-700"}`,children:a.article_word?.article_word||"Removed"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-full flex items-center text-xs font-medium transition",onClick:p=>{p.stopPropagation(),oe(a,"accept")},children:[e.jsx(ht,{className:"w-3.5 h-3.5 mr-1"})," ","Accept"]}),e.jsxs("button",{className:"flex items-center text-gray-700 hover:text-red-600 px-3 rounded-full border-2 hover:bg-red-50 text-xs font-medium transition",onClick:p=>{p.stopPropagation(),oe(a,"dismiss")},children:[e.jsx(Vt,{className:"w-3.5 h-3.5 mr-1"})," ","Ignore"]})]})]},`${a.index_compared}-${a.type}`)),d.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ht,{className:"mt-20 w-12 h-12 text-green-500 mx-auto mb-3"}),e.jsx("h5",{className:"text-base font-semibold text-gray-700 mb-1",children:"Perfect Match!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your text matches the article exactly."})]})]})}),e.jsx(ue,{show:R,onClose:D,maxWidth:"xl",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:ee?e.jsx("div",{className:"py-2 text-center",children:"Loading…"}):g?g.notFound?"Are You Sure?":"Explanation":e.jsx(e.Fragment,{children:" "})}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:D,"aria-label":"Close",children:"✕"})]})}),ee?e.jsx("div",{className:"py-8 text-center",children:"Loading…"}):g?e.jsx("div",{className:"space-y-3 text-sm text-gray-700",children:g.notFound?e.jsxs("div",{children:[H==="accept"&&e.jsxs("div",{className:"text-sm text-gray-700 mb-4",children:["Are you sure you want to continue with the word"," ",e.jsx("span",{className:"font-semibold text-green-600",children:g.word})]}),H==="dismiss"&&e.jsxs("div",{className:"text-sm text-gray-700 mb-4",children:["Are you sure you want to ignore the word"," ",e.jsx("span",{className:"text-red-600 font-semibold",children:g.word})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 gap-3",children:[e.jsx("button",{type:"button",onClick:D,className:"rounded-[10px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"}),H==="accept"&&e.jsx("button",{type:"button",onClick:ce,className:"rounded-[10px] px-9 py-1 bg-green-600 text-white font-semibold hover:bg-green-700 transition",children:"Accept"}),H==="dismiss"&&e.jsx("button",{type:"button",onClick:ce,className:"rounded-[10px] px-9 py-1 bg-red-600 text-white font-semibold hover:bg-red-700 transition",children:"Ignore"})]})]}):e.jsxs(e.Fragment,{children:[g.displayedWord&&e.jsx("div",{children:e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-lg",children:g.displayedWord}),g.isHomophone&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(homophone of"," ",e.jsx("strong",{children:g.word}),")"]})," — ",g.shortDescription||`This word is commonly used to describe or refer to ${g.word}.`]})}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Part of Speech"}),e.jsx("div",{className:"text-sm",children:g.pos||"—"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Pronunciation"}),e.jsx("div",{className:"text-sm",children:g.pro||g.phoneme||"—"})]})]}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Homophones"}),e.jsx("div",{className:"text-sm",children:Array.isArray(g.homophone)?g.homophone.join(", "):"—"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"phoneme"}),e.jsx("div",{className:"text-sm",children:typeof g.phoneme=="string"&&g.phoneme.trim()?g.phoneme:Array.isArray(g.phoneme)&&g.phoneme.length?g.phoneme.join(", "):"—"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Definition"}),e.jsx("div",{className:"text-sm",children:g.definition||"—"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-medium text-slate-500",children:"Example"}),e.jsx("div",{className:"text-sm",children:g.example||"—"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 gap-3",children:[e.jsx("button",{type:"button",onClick:D,className:"rounded-[10px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"}),H==="accept"&&e.jsx("button",{type:"button",onClick:ce,className:"rounded-[10px] px-9 py-1 bg-green-600 text-white font-semibold hover:bg-green-700 transition disabled:opacity-60",children:"Accept"}),H==="dismiss"&&e.jsx("button",{type:"button",onClick:ce,className:"rounded-[10px] px-9 py-1 bg-red-600 text-white font-semibold hover:bg-red-700 transition",children:"Ignore"})]})]})}):e.jsx("div",{className:"py-6 text-center text-sm text-gray-500",children:"No data available."})]})})]})}return e.jsxs("div",{className:"w-96 rounded-xl border border-gray-200 bg-white h-[75vh] flex flex-col overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-6 pt-4 pb-2 border-gray-200",children:[B?e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm animate-pulse mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}):e.jsx("div",{className:"flex items-center justify-between font-semibold mb-3",children:k.split(" ").filter(i=>i.trim()).length<25?`Enter at least 25 words (${k.split(" ").filter(i=>i.trim()).length}/25)`:"Grammar Check Results"}),B?e.jsxs("div",{className:"flex items-center space-x-2 animate-pulse mb-1",children:[e.jsx("div",{className:"h-8 w-20 bg-slate-200 rounded-lg"}),e.jsx("div",{className:"h-8 w-28 bg-slate-200 rounded-lg"})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"text-sm text-blue-900 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["All"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:"0"})]}),e.jsxs("button",{className:"text-sm text-green-600 px-3 py-1.5 font-medium flex items-center hover:bg-gray-100 rounded-lg transition",children:["Grammar"," ",e.jsx("span",{className:"text-xs bg-gray-200 rounded-full px-2 py-0.5 ml-2",children:"0"})]})]}),e.jsx("div",{className:"border-b"})]}),e.jsx("div",{className:"space-y-2 px-4 py-0 mb-2 flex-1 overflow-y-auto hide-scrollbar",children:B?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center border border-gray-200 rounded-xl px-4 py-2 bg-white shadow-sm",children:[e.jsx("div",{className:"h-4 w-40 bg-slate-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"})]}),[...Array(3)].map((i,o)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"h-3 w-24 bg-slate-200 rounded mb-3"}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx("div",{className:"h-4 w-16 bg-slate-300 rounded"}),e.jsx("div",{className:"h-4 w-20 bg-slate-200 rounded"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("div",{className:"h-6 w-20 bg-slate-300 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-slate-200 rounded-full"})]})]},o))]}):e.jsxs("div",{className:"text-center flex flex-col items-center justify-center h-full",children:[e.jsx("img",{src:"/images/binoculars-see.svg",alt:"Icon",className:"w-16 h-16"}),e.jsx("h5",{className:"text-base font-semibold text-gray-700",children:"Nothing to check yet!"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get started by adding text to the editor"})]})})]})}function rs(){const{auth:k}=ze().props,N=k?.user?.id,[L,j]=r.useState(!1),[q,C]=r.useState(!1),[B,K]=r.useState(!1),[Q,R]=r.useState(!1),[me,ee]=r.useState(!1),[P,g]=r.useState([]),[E,X]=r.useState(!1),[T,xe]=r.useState(null),[$,_e]=r.useState([]),[pt,Ae]=r.useState(!1),[Se,he]=r.useState([]),[ke,Ce]=r.useState(!1),[Te,pe]=r.useState(null),[Ve,De]=r.useState(!1),[Me,fe]=r.useState(null),[Re,te]=r.useState(!1),[Ee,z]=r.useState(null),[ge,se]=r.useState(!1),[Z,ye]=r.useState(null),[ae,re]=r.useState(!1),[F,H]=r.useState([]),[$e,ie]=r.useState(!1),[W,He]=r.useState(""),[S,je]=r.useState(""),[b,be]=r.useState(null),[ne,D]=r.useState(!1),[ce,oe]=r.useState([]),[G,Ge]=r.useState(!1),[ve,Le]=r.useState([]),[f,Fe]=r.useState(null),[U,J]=r.useState(!1),le=r.useRef(null),h=r.useRef(null),[I,O]=r.useState(null),[we,V]=r.useState(!1),[i,o]=r.useState(null),[d,a]=r.useState(null),[l,p]=r.useState(!1),[n,x]=r.useState(0),[_,M]=r.useState(0),[A,de]=r.useState(null),[Oe,Ye]=r.useState(null),Ie=r.useRef(!1),[qe,Ke]=r.useState(null),[Y,Xe]=r.useState(()=>k?.can?.student===!0?!0:k?.can?.student===!1?!1:typeof window<"u"&&window.__canAccessLibrary!==void 0?window.__canAccessLibrary:null);r.useEffect(()=>{if(Y!==null||!k?.user)return;let t=!1;return(async()=>{try{const u=(await fetch(route("api.user.can-access-library"),{headers:{"X-Requested-With":"XMLHttpRequest"}})).ok;t||(Xe(u),typeof window<"u"&&(window.__canAccessLibrary=u))}catch{t||Xe(!1)}})(),()=>t=!0},[k?.user,Y]),r.useEffect(()=>{const t=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;de(t);try{sessionStorage.setItem("sessionId",t)}catch{}},[]);const Pe=()=>{N&&y.get("/grammar-checkers",{headers:{Accept:"application/json"}}).then(t=>{const s=Array.isArray(t.data)?t.data:t.data.data||[];oe(s)}).catch(t=>{t.response?.status!==401&&console.error("Error fetching history:",t),oe([])})};async function Ze(t=null){if(t){se(!0);try{const s=["/api/user-activities/stats","/api/user-activity-stats","/api/stats/user-activities"];for(const u of s)try{const c=await y.get(u,{params:{grammar_checker_id:t},headers:{Accept:"application/json"}}),m=c.data?.data??c.data??null;if(m&&typeof m=="object"){z(m),se(!1);return}}catch{continue}z(null)}catch(s){console.error("Error fetching activity stats:",s),z(null)}finally{se(!1)}}}async function Je(t=null){if(t){re(!0);try{const s=[`/api/user-homophone-accuracies?grammar_checker_id=${t}`,`/api/homophone-accuracies?grammar_checker_id=${t}`,`/api/accuracies?grammar_checker_id=${t}`];for(const u of s)try{const c=await y.get(u,{headers:{Accept:"application/json"}}),m=c.data?.data??c.data??null;if(m){const v=Array.isArray(m)?m[0]:m;if(v){ye(v),re(!1);return}}}catch{continue}ye(null)}catch(s){console.error("Error fetching accuracy stats:",s),ye(null)}finally{re(!1)}}}async function Qe(t=null){if(t){ie(!0);try{const s=await y.get("/api/user-comparison-activities",{params:{grammar_checker_id:t,limit:50},headers:{Accept:"application/json"}}),u=Array.isArray(s.data)?s.data:s.data?.data??[];H(u)}catch(s){console.error("Error fetching comparison activities:",s),H([])}finally{ie(!1)}}}const ft=async()=>{if(Y===null){console.warn("Permission check still in progress, please try again");return}if(b)Y===!0?(K(!0),await Promise.all([Ze(b),Qe(b),Je(b)])):(R(!0),await et());else{D(!0);try{await We(W,S),Y===!0?(K(!0),setTimeout(async()=>{b&&await Promise.all([Ze(b),Qe(b),Je(b)])},0)):(R(!0),await et())}catch(t){console.error("Error during save:",t),D(!1)}}},et=async()=>{ee(!0);try{const t=await y.get("/grammar-checkers",{headers:{Accept:"application/json"}}),s=Array.isArray(t.data)?t.data:t.data.data||[];g(s)}catch(t){console.error("Error fetching history:",t),g([])}finally{ee(!1)}};async function gt(t=null){if(t){Ae(!0);try{const s=await y.get("/api/user-comparison-activities",{params:{grammar_checker_id:t,limit:50},headers:{Accept:"application/json"}}),u=Array.isArray(s.data)?s.data:s.data?.data??[];_e(u)}catch(s){console.error("Error fetching history comparison activities:",s),_e([])}finally{Ae(!1)}}}async function yt(t=null){if(t){Ce(!0);try{const s=["/api/user-audio-activities","/api/audio-activities"];for(const u of s)try{const c=await y.get(u,{params:{grammar_checker_id:t},headers:{Accept:"application/json"},validateStatus:v=>v<500}),m=Array.isArray(c.data)?c.data:c.data?.data??[];if(c.status===200){he(m);return}}catch{continue}he([])}catch(s){console.error("Error fetching history audio activities:",s),he([])}finally{Ce(!1)}}}async function jt(t=null){if(!(!t||!N)){te(!0);try{const s=[`/api/user-homophone-accuracies?grammar_checker_id=${t}&user_id=${N}`,`/api/homophone-accuracies?grammar_checker_id=${t}`,`/api/accuracies?grammar_checker_id=${t}`];for(const u of s)try{const c=await y.get(u,{headers:{Accept:"application/json"}}),m=c.data?.data??c.data??null;if(m){const v=Array.isArray(m)?m[0]:m;if(v&&v.accuracy!=null){fe(v);return}}}catch{continue}fe(null)}catch(s){console.error("Error fetching history detail accuracy:",s),fe(null)}finally{te(!1)}}}async function bt(t=null){if(t){De(!0);try{const s=["/api/user-activities/stats","/api/user-activity-stats","/api/stats/user-activities"];for(const u of s)try{const c=await y.get(u,{params:{grammar_checker_id:t},headers:{Accept:"application/json"}}),m=c.data?.data??c.data??null;if(m&&typeof m=="object"){pe(m);return}}catch{continue}pe(null)}catch(s){console.error("Error fetching history detail stats:",s),pe(null)}finally{De(!1)}}}const vt=async t=>{xe(t),X(!0),await Promise.all([gt(t.id),yt(t.id),bt(t.id),jt(t.id)])};r.useEffect(()=>{N&&y.get("/api/articles",{headers:{Accept:"application/json"}}).then(t=>{Le(Array.isArray(t.data)?t.data:t.data.data||[])}).catch(t=>{t.response?.status!==401&&console.error("Error fetching articles:",t),Le([])})},[N]),r.useEffect(()=>{Pe()},[N]),r.useEffect(()=>{if(!U)return;const t=s=>{le.current&&!le.current.contains(s.target)&&J(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[U]);const Ne=r.useRef(),wt=async t=>{if(!t||!t.trim())return 0;try{const s=await y.post("/api/khmer-segment",{text:t},{headers:{"Content-Type":"application/json"}});return s.data&&Array.isArray(s.data.tokens)?s.data.tokens.length:t.trim().split(/\s+/).length}catch(s){return console.error("Khmer segment API error:",s),t.trim().split(/\s+/).length}},Nt=t=>Math.ceil(t/200*60),tt=async()=>{if(!(!f||!S.trim())){p(!0);try{const t=await y.post("/api/compare",{article_id:f.id,user_input:S});t.data&&Array.isArray(t.data.comparison)?a(t.data):(console.error("Invalid comparison result format:",t.data),a(null))}catch(t){console.error("Error in comparison:",t),a(null)}finally{p(!1)}}},We=async(t,s)=>{if(!N)return;D(!0);const u=await wt(s),c={user_id:N,title:t??"",paragraph:s??"",word_count:u,incorrect_word_count:0,reading_time:Nt(u),article_id:f?f.id:null};if(b)try{const m=await y.patch(`/grammar-checkers/${b}`,c,{headers:{Accept:"application/json"}}),v=m.data?.id??m.data?.data?.id??b;be(v),Pe(),Ke(Date.now()),f&&s.trim()&&tt()}catch(m){console.error("Save update error:",m.response?.data??m)}finally{D(!1)}else{if(Ie.current){D(!1);return}Ie.current=!0;try{const m=await y.post("/grammar-checkers",c,{headers:{Accept:"application/json"}}),v=m.data?.id??m.data?.data?.id??null;v&&be(v),Pe(),Ke(Date.now()),f&&s.trim()&&tt()}catch(m){console.error("Save Document error:",m.response?.data??m)}finally{Ie.current=!1,D(!1)}}};r.useEffect(()=>{if(!(!N||!W.trim()&&!S.trim()))return Ne.current&&clearTimeout(Ne.current),Ne.current=setTimeout(()=>{We(W,S)},700),()=>clearTimeout(Ne.current)},[W,S]);const Be=t=>{t.preventDefault(),C(!0)};r.useEffect(()=>{j(!k.user)},[k.user]);const st=r.useRef(""),at=t=>{const s=t.target.value;if(!N||!b)return;const u=st.current,c=u.length,m=s.length;if(m>c){const v=s.slice(c);setTimeout(()=>{v.split("").forEach(w=>{y.post("/api/track/typing",{grammar_checker_id:Number(b),user_id:Number(N),character:w,status:1}).catch(()=>{})})},80)}else if(m<c){const v=c-m,w=u.slice(-v);setTimeout(()=>{w.split("").forEach(Mt=>{y.post("/api/track/typing",{grammar_checker_id:Number(b),user_id:Number(N),character:Mt,status:0}).catch(()=>{})})},80)}st.current=s},rt=async t=>{if(Fe(t),J(!1),He(t?t.title:""),o(null),!t){O(null);return}const s=t.audios_id;if(!s){O(null);return}try{const c=(await y.get(`/api/audios/${s}`)).data?.data;c&&c.file_path?O(c.file_path):(O(null),o("Audio file not found"))}catch(u){console.error("Failed to fetch audio:",u),o("Unable to load audio for this article."),O(null)}h.current&&(h.current.pause(),h.current.currentTime=0),V(!1),b&&We(W,S)},_t=()=>{if(!I||!h.current){o("No audio available to play.");return}if(we){const t=Date.now();Ye(t),h.current.pause(),V(!1),N&&f?.audios_id&&y.post("/api/track/audio-activity",{audio_id:f.audios_id,article_id:f.id,grammar_checker_id:b??null,activity_type:"audio_pause",playback_position:h.current.currentTime,pause_duration:0,session_id:A}).catch(s=>console.error("Track audio pause error:",s))}else{let t=0;Oe&&(t=(Date.now()-Oe)/1e3,Ye(null)),h.current.play().then(()=>{V(!0),N&&f?.audios_id&&y.post("/api/track/audio-activity",{audio_id:f.audios_id,article_id:f.id,grammar_checker_id:b??null,activity_type:"audio_play",playback_position:h.current.currentTime,pause_duration:t,session_id:A}).catch(s=>console.error("Track audio play error:",s))}).catch(s=>{console.error("Playback failed:",s),o("Failed to play audio. Please try again."),V(!1)})}},At=()=>{h.current&&(h.current.currentTime,h.current.currentTime=Math.min(h.current.currentTime+10,h.current.duration),N&&f?.audios_id&&y.post("/api/track/audio-activity",{audio_id:f.audios_id,article_id:f.id,grammar_checker_id:b??null,activity_type:"audio_forward",playback_position:h.current.currentTime,session_id:A}).catch(t=>console.error("Track audio forward error:",t)))},St=()=>{h.current&&(h.current.currentTime,h.current.currentTime=Math.max(h.current.currentTime-10,0),N&&f?.audios_id&&y.post("/api/track/audio-activity",{audio_id:f.audios_id,article_id:f.id,grammar_checker_id:b??null,activity_type:"audio_rewind",playback_position:h.current.currentTime,session_id:A}).catch(t=>console.error("Track audio rewind error:",t)))},kt=()=>{h.current&&x(h.current.currentTime)},Ct=()=>{h.current&&M(h.current.duration)},Tt=()=>{V(!1),h.current&&(h.current.currentTime=0)},Dt=t=>{if(h.current){const s=t.currentTarget.getBoundingClientRect(),u=(t.clientX-s.left)/s.width;h.current.currentTime=u*h.current.duration}},it=t=>{if(isNaN(t))return"0:00";const s=Math.floor(t/60),u=Math.floor(t%60);return`${s}:${u.toString().padStart(2,"0")}`};r.useEffect(()=>{(!S.trim()||!f)&&a(null)},[S,f]);const nt=()=>{const t=["replaced","missing","extra"],s={replaced_accept:"#34d399",replaced_dismiss:"#f87171",missing_accept:"#60a5fa",missing_dismiss:"#fbbf24",extra_accept:"#a78bfa",extra_dismiss:"#f472b6"},u=[];return t.forEach(c=>{const m=F.filter(w=>w.comparison_type===c&&w.action==="accept").length,v=F.filter(w=>w.comparison_type===c&&w.action==="dismiss").length;u.push({name:c==="replaced"?"Incorrect Accept":`${c.charAt(0).toUpperCase()+c.slice(1)} Accept`,value:m,color:s[`${c}_accept`]}),u.push({name:c==="replaced"?"Incorrect Dismiss":`${c.charAt(0).toUpperCase()+c.slice(1)} Dismiss`,value:v,color:s[`${c}_dismiss`]})}),u.filter(c=>c.value>0)};return e.jsxs(e.Fragment,{children:[e.jsx($t,{title:"Homophone Check"}),e.jsx(Ht,{}),e.jsx(Rt,{}),e.jsxs("section",{className:"relative py-4",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8",children:e.jsxs("div",{className:`flex flex-row gap-4 transition-all duration-300 ${L?"blur-sm":""}`,children:[e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 shadow-sm p-6 h-[75vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[I?e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("audio",{ref:h,src:I,onTimeUpdate:kt,onLoadedMetadata:Ct,onEnded:Tt,className:"hidden"}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-xl px-3 py-1 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:_t,className:"w-6 h-6 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-full transition",children:we?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsxs("div",{className:"flex space-x-0",children:[e.jsx("button",{onClick:St,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full transition",title:"Back 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),e.jsx("path",{d:"M3 3v5h5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})}),e.jsx("button",{onClick:At,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full transition",title:"Forward 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e.jsx("path",{d:"M21 3v5h-5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:it(n)}),e.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full cursor-pointer relative",onClick:Dt,children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${n/_*100||0}%`}})}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:it(_)})]})]})})]}):e.jsx("div",{}),e.jsxs("div",{className:"relative w-64",ref:le,children:[e.jsxs("button",{type:"button",className:"w-full px-3 py-2.5 text-sm bg-white border border-gray-300 rounded-xl shadow-sm text-left flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>J(!U),children:[f?f.title:"Select an Article",e.jsx("svg",{className:`w-4 h-4 ml-2 transition-transform ${U?"rotate-180":"rotate-0"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),U&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-60 overflow-y-auto hide-scrollbar",children:e.jsxs("div",{className:"px-2 py-2 space-y-1",children:[e.jsx("button",{type:"button",className:`w-full text-left px-4 py-2 text-sm rounded-xl transition ${f?"hover:bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700 font-medium"}`,onClick:()=>rt(null),children:"Select an Article"}),ve.map((t,s)=>e.jsxs("button",{type:"button",className:`w-full text-left px-4 py-2 text-sm rounded-lg transition ${f&&f.id===t.id?"bg-blue-100 text-blue-700 font-medium":"hover:bg-gray-100 text-gray-700"}`,onClick:()=>rt(t),children:[e.jsx("span",{className:"font-mono text-gray-500",children:s+1}),". ",t.title]},t.id))]})})]})]}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{className:`w-full h-[54vh] text-md bg-white border border-gray-200 rounded-xl py-3 px-3 focus:outline-none focus:ring-1 focus:ring-blue-500 placeholder-gray-500 resize-none overflow-y-auto hide-scrollbar ${G?"min-h-[50vh]":""}`,placeholder:"Type your text here...",value:S,onChange:t=>{je(t.target.value),at(t)},onInput:at,onDoubleClick:()=>Ge(!G),disabled:!f,onCopy:Be,onPaste:Be,onCut:Be})}),e.jsx("div",{className:"flex justify-end items-center mt-1",children:e.jsx("button",{type:"button",onClick:ft,disabled:ne||l||!S.trim()||Y===null,className:`px-6 py-1 rounded-xl font-medium transition ${ne||l||!S.trim()||Y===null?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:ne||l?"Checking...":"Save"})})]}),e.jsx(Ot,{text:S,onReplace:je,checkerId:b,comparisonResult:d,setComparisonResult:a,articleId:f?.id,isChecking:l})]})}),e.jsx(ue,{show:B,onClose:()=>K(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"p-6 flex flex-col",style:{maxHeight:"80vh"},children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Article Name: ",W||"Untitled document"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Date:"," ",qe?new Date(qe).toLocaleDateString():"—"]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 text-sm text-gray-700",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-500",children:"Your Article"}),e.jsx("div",{className:"mt-1 bg-slate-50 p-3 rounded text-sm leading-relaxed whitespace-pre-wrap break-words max-h-60 overflow-auto",children:S??""})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Distribution Actions"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Share of action by group"})]}),e.jsx(ot,{width:"100%",height:280,children:e.jsxs(mt,{children:[e.jsx(xt,{data:nt(),cx:"50%",cy:"50%",outerRadius:90,dataKey:"value",labelLine:!1,children:nt().map((t,s)=>e.jsx(lt,{fill:t.color},`cmp-${s}`))}),e.jsx(dt,{formatter:(t,s)=>[`${t}`,s]}),e.jsx(ut,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Replaced:"," ",e.jsx("span",{className:"font-medium text-green-700",children:F.filter(t=>t.comparison_type==="replaced"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:F.filter(t=>t.comparison_type==="replaced"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Missing:"," ",e.jsx("span",{className:"font-medium text-green-700",children:F.filter(t=>t.comparison_type==="missing"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:F.filter(t=>t.comparison_type==="missing"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Extra:"," ",e.jsx("span",{className:"font-medium text-green-700",children:F.filter(t=>t.comparison_type==="extra"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:F.filter(t=>t.comparison_type==="extra"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Accuracy:"," ",e.jsx("span",{className:"font-medium text-gray-800",children:ae?"…":Z?.accuracy!=null?`${Number(Z.accuracy).toFixed(2)}%`:"0%"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Avg Pause (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:ge?"…":Ee?.avg_pause_duration!=null?Number(Ee.avg_pause_duration).toFixed(2):"0"})]}),e.jsxs("div",{children:["Audio Plays:"," ",e.jsx("span",{className:"font-medium text-blue-700",children:"0"})]}),e.jsxs("div",{children:["Audio Pauses:"," ",e.jsx("span",{className:"font-medium text-orange-700",children:"0"})]}),e.jsxs("div",{children:["Reading Time (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Z?.reading_time_seconds??"0"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>K(!1),className:"rounded-[10px] border-2 border-gray-300 px-6 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})}),e.jsx(ue,{show:Q,onClose:()=>R(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Homophone History"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700 text-lg mr-2",onClick:()=>R(!1),children:"✕"})]}),me?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"Loading history..."})}):P.length===0?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"No Homophone found."})}):e.jsx("div",{className:"overflow-x-auto max-h-[50vh] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"No"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Words"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Reading Time"}),e.jsx("th",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:P.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-600",children:s+1}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-800",children:t.title||"Untitled document"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:t.word_count??"0"}),e.jsxs("td",{className:"px-4 py-3 text-center text-gray-700",children:[t.reading_time??"0","s"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{type:"button",className:"rounded-[10px] border-2 border-blue-500 px-3 py-1 text-blue-700 hover:bg-blue-500 hover:text-white transition font-medium",onClick:()=>vt(t),children:"View"})})]},t.id))})]})}),e.jsx("div",{className:"mt-6 flex justify-end px-6",children:e.jsx("button",{onClick:()=>R(!1),className:"rounded-[10px] border-2 border-gray-500 px-4 py-1 text-gray-600 hover:bg-gray-500 hover:text-white transition font-medium",children:"Close"})})]})}),E&&T&&e.jsx(ue,{show:E,onClose:()=>{X(!1),xe(null)},maxWidth:"2xl",children:e.jsxs("div",{className:"p-6 flex flex-col",style:{maxHeight:"80vh"},children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Article Name:  ",T?.title||"Untitled document"]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Date: ",T?.created_at?new Date(T.created_at).toLocaleDateString():"N/A"]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 text-sm text-gray-700",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-500",children:"Your Article"}),e.jsx("div",{className:"mt-1 bg-slate-50 p-3 rounded text-sm leading-relaxed whitespace-pre-wrap break-words max-h-60 overflow-auto",children:T?.paragraph??""})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Distribution Actions"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Share of action by group"})]}),e.jsx(ot,{width:"100%",height:280,children:e.jsxs(mt,{children:[e.jsx(xt,{data:(()=>{const t=["replaced","missing","extra"],s={replaced_accept:"#34d399",replaced_dismiss:"#f87171",missing_accept:"#60a5fa",missing_dismiss:"#fbbf24",extra_accept:"#a78bfa",extra_dismiss:"#f472b6"},u=[];return t.forEach(c=>{const m=$.filter(w=>w.comparison_type===c&&w.action==="accept").length,v=$.filter(w=>w.comparison_type===c&&w.action==="dismiss").length;u.push({name:c==="replaced"?"Incorrect Accept":`${c.charAt(0).toUpperCase()+c.slice(1)} Accept`,value:m,color:s[`${c}_accept`]}),u.push({name:c==="replaced"?"Incorrect Dismiss":`${c.charAt(0).toUpperCase()+c.slice(1)} Dismiss`,value:v,color:s[`${c}_dismiss`]})}),u.filter(c=>c.value>0)})(),cx:"50%",cy:"50%",outerRadius:90,dataKey:"value",labelLine:!1,children:(()=>{const t=["replaced","missing","extra"],s={replaced_accept:"#34d399",replaced_dismiss:"#f87171",missing_accept:"#60a5fa",missing_dismiss:"#fbbf24",extra_accept:"#a78bfa",extra_dismiss:"#f472b6"},u=[];return t.forEach(c=>{const m=$.filter(w=>w.comparison_type===c&&w.action==="accept").length,v=$.filter(w=>w.comparison_type===c&&w.action==="dismiss").length;u.push({name:c==="replaced"?"Incorrect Accept":`${c.charAt(0).toUpperCase()+c.slice(1)} Accept`,value:m,color:s[`${c}_accept`]}),u.push({name:c==="replaced"?"Incorrect Dismiss":`${c.charAt(0).toUpperCase()+c.slice(1)} Dismiss`,value:v,color:s[`${c}_dismiss`]})}),u.filter(c=>c.value>0)})().map((t,s)=>e.jsx(lt,{fill:t.color},`cmp-${s}`))}),e.jsx(dt,{formatter:(t,s)=>[`${t}`,s]}),e.jsx(ut,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Replaced:"," ",e.jsx("span",{className:"font-medium text-green-700",children:$.filter(t=>t.comparison_type==="replaced"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:$.filter(t=>t.comparison_type==="replaced"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Missing:"," ",e.jsx("span",{className:"font-medium text-green-700",children:$.filter(t=>t.comparison_type==="missing"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:$.filter(t=>t.comparison_type==="missing"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Extra:"," ",e.jsx("span",{className:"font-medium text-green-700",children:$.filter(t=>t.comparison_type==="extra"&&t.action==="accept").length}),e.jsxs("span",{className:"text-gray-400",children:[" ","(a) /"," "]}),e.jsx("span",{className:"font-medium text-red-700",children:$.filter(t=>t.comparison_type==="extra"&&t.action==="dismiss").length}),e.jsx("span",{className:"text-gray-400",children:" (d) "})]}),e.jsxs("div",{children:["Accuracy:"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Re?"…":Me?.accuracy!=null?`${Number(Me.accuracy).toFixed(2)}%`:T?._acc?.accuracy!=null?`${Number(T._acc.accuracy).toFixed(2)}%`:"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm text-slate-600 mt-4",children:[e.jsxs("div",{children:["Avg Pause (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:Ve?"…":Te?.avg_pause_duration!=null?Number(Te.avg_pause_duration).toFixed(2):T?._acc?.avg_pause_duration!=null?Number(T._acc.avg_pause_duration).toFixed(2):"N/A"})]}),e.jsxs("div",{children:["Audio Plays:"," ",e.jsx("span",{className:"font-medium text-blue-700",children:ke?"…":Se.filter(t=>t.activity_type==="audio_play").length||"0"})]}),e.jsxs("div",{children:["Audio Pauses:"," ",e.jsx("span",{className:"font-medium text-orange-700",children:ke?"…":Se.filter(t=>t.activity_type==="audio_pause").length||"0"})]}),e.jsxs("div",{children:["Reading Time (s):"," ",e.jsx("span",{className:"font-medium text-gray-800",children:T?.reading_time??"0"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>{X(!1),xe(null)},className:"rounded-[10px] border-2 border-gray-300 px-6 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})}),L&&e.jsx("div",{className:"absolute inset-0 bg-opacity-20 flex items-center justify-center z-10",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8 w-full max-w-xl mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-gray-900 mb-2",children:"Create an account to get started"}),e.jsx("p",{className:"text-gray-600 text-md leading-relaxed font-sans",children:"Create a free SorSer account to start Grammar Checker with AI"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:route("auth.google"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Sign Up with Google"})]}),e.jsxs(ct,{href:route("register"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.jsxs("svg",{className:"w-12 h-12 text-gray-700",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),e.jsx("span",{className:"font-medium text-gray-500",children:"Sign Up by Email"})]})]}),e.jsxs("div",{className:"mt-6 text-md",children:[e.jsx("span",{className:"text-gray-500",children:"Or "}),e.jsx(ct,{href:route("login"),children:e.jsx("span",{className:"text-blue-500 font-medium",children:"Sign In"})})," ","to an existing account"]})]})})}),e.jsx(ue,{show:q,onClose:()=>C(!1),maxWidth:"xl",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),C(!1)},className:"p-6 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Action Not Allowed"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Copy, paste, and cut actions are disabled while typing in this field."}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"inline-block px-2 py-0.5 text-xs font-medium text-red-800 bg-red-100 rounded",children:"Please type manually."})}),e.jsx("div",{className:"flex justify-end gap-3 mt-3",children:e.jsx("button",{type:"button",onClick:()=>C(!1),className:"rounded-[10px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})})]}),e.jsx(Gt,{}),e.jsx(Lt,{})]})}export{rs as default};
