import{r as i,j as e,S as M,x as R,A as C}from"./app-BjqCgIyx.js";import{A as U}from"./AdminLayout-B7XET_EX.js";import{B as W}from"./Breadcrumb-CypNNXXb.js";function P({datas:s,isEdit:a}){var N;const d=a?"Edit Article":"Create Article",[n,c]=i.useState({title:(s==null?void 0:s.title)??"",file:null,audio:null}),[k,x]=i.useState(null),[h,m]=i.useState(null),[v,j]=i.useState(!1),[o,p]=i.useState({}),f=i.useRef(null),b=i.useRef(null);i.useEffect(()=>{s&&(c({title:s.title||"",file:null,audio:null}),x(s.file?y(s.file,"files"):null),m(s.audio?y(s.audio,"audios"):null))},[s]);const y=(t,r)=>{if(!t)return null;if(typeof t=="string")return t.startsWith("http")||t.startsWith("/")?t:`/storage/uploads/${r}/${t}`;if(t.url)return t.url;if(t.path){const l=t.path.replace(/^public\//,"");return t.path.startsWith("http")||t.path.startsWith("/")?t.path:`/storage/${l}`}if(t.file_path){const l=String(t.file_path);return l.startsWith("http")||l.startsWith("/")?l:l.startsWith("public/")?`/storage/${l.replace(/^public\//,"")}`:`/storage/${l}`}return t.filename?`/storage/uploads/${r}/${t.filename}`:t.name?`/storage/uploads/${r}/${t.name}`:null},w=t=>t?typeof t=="string"?t.split("/").pop():t.title||t.filename||t.name||null:null,A=t=>{const{name:r,value:l}=t.target;c({...n,[r]:l})},S=t=>{const r=t.target.files[0];c({...n,file:r||null}),x(r?URL.createObjectURL(r):null)},F=t=>{const r=t.target.files[0];c({...n,audio:r||null}),m(r?URL.createObjectURL(r):null)},L=t=>{t.preventDefault(),j(!0),p({});const r={...n},l=new FormData;l.append("title",r.title??""),r.file&&l.append("file",r.file),r.audio&&l.append("audio",r.audio);const u=()=>j(!1);a?(l.append("_method","PATCH"),C.post(route("articles.update",s.id),l,{forceFormData:!0,onFinish:u,onError:g=>{p(g||{}),u()}})):C.post(route("articles.store"),l,{forceFormData:!0,onFinish:u,onError:g=>{p(g||{}),u()}})},$=[{title:"Home",url:"/"},{title:d,url:""}];return e.jsxs(U,{breadcrumb:e.jsx(W,{header:d,links:$}),children:[e.jsx(M,{title:d}),e.jsx("div",{className:"bg-gradient-to-br from-slate-50 to-blue-50/30 mb-12",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"border-b mb-3",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:a?"Edit Article":"Create New Article"}),e.jsx("p",{className:"text-sm text-gray-500",children:a?"Update the details of this article below.":"Fill out the form below to create a new article."})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4",encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title"}),e.jsx("input",{name:"title",type:"text",value:n.title,onChange:A,className:`w-full border rounded-md px-3 py-2 ${o.title?"border-red-500":""}`,placeholder:"Enter article title"}),o.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Select File ",e.jsx("span",{children:" "})]}),e.jsxs("div",{className:"flex items-center justify-center h-32 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 cursor-pointer relative bg-gray-50 hover:bg-blue-50 transition",onClick:()=>{f.current&&f.current.click()},style:{minHeight:100},children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.txt",ref:f,onChange:S,className:"absolute inset-0 opacity-0 cursor-pointer",tabIndex:-1,style:{pointerEvents:"auto"},onClick:t=>t.stopPropagation()}),e.jsxs("div",{className:"text-center space-y-2 pointer-events-none",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-8 w-8 text-gray-400 pointer-events-none",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 16a1 1 0 0 1-1-1V9.414L8.707 11.707a1 1 0 1 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L13 9.414V15a1 1 0 0 1-1 1z"}),e.jsx("path",{d:"M4 18a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1z"})]}),e.jsx("div",{className:"text-sm text-gray-500 pointer-events-none",children:"Select a file or drag here"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition pointer-events-none",children:n.file?"Change file":"Select a file"})]})]}),o.file&&e.jsx("div",{className:"text-red-600 mt-2 text-sm",children:o.file}),k&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border rounded-xl p-3 mt-3 hover:bg-gray-100 transition",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg flex items-center justify-center text-green-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-file-json2-icon lucide-file-json-2",children:[e.jsx("path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}),e.jsx("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),e.jsx("path",{d:"M4 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1"}),e.jsx("path",{d:"M8 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1"})]})}),e.jsx("div",{className:"flex items-center mt-2 space-x-2 justify-center",children:e.jsx("p",{className:"text-sm font-medium text-gray-800",children:n.file?n.file.name:w(s==null?void 0:s.file)||"Download"})})]}),e.jsx("button",{onClick:()=>x(null),className:"ml-4 text-gray-400 hover:text-gray-600 flex items-center justify-center",children:"✕"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Upload Audio ",e.jsx("span",{})]}),e.jsxs("div",{className:"flex items-center justify-center h-32 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 cursor-pointer relative bg-gray-50 hover:bg-blue-50 transition",onClick:()=>{b.current&&b.current.click()},style:{minHeight:100},children:[e.jsx("input",{type:"file",accept:"audio/*",ref:b,onChange:F,className:"absolute inset-0 opacity-0 cursor-pointer",tabIndex:-1,style:{pointerEvents:"auto"},onClick:t=>t.stopPropagation()}),e.jsxs("div",{className:"text-center space-y-2 pointer-events-none",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-8 w-8 text-gray-400 pointer-events-none",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 16a1 1 0 0 1-1-1V9.414L8.707 11.707a1 1 0 1 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L13 9.414V15a1 1 0 0 1-1 1z"}),e.jsx("path",{d:"M4 18a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1z"})]}),e.jsx("div",{className:"text-sm text-gray-500 pointer-events-none",children:"Select an audio file or drag here"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition pointer-events-none",children:n.audio?"Change Audio":"Select Audio"})]})]}),o.audio&&e.jsx("div",{className:"text-red-600 mt-2 text-sm",children:o.audio}),h&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 border rounded-xl p-3 mt-3 hover:bg-gray-100 transition",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg flex items-center justify-center text-blue-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M9 18V5l12-2v13"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("circle",{cx:"18",cy:"16",r:"3"})]})}),e.jsxs("div",{className:"flex items-center justify-between w-full space-x-4 mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:((N=n.audio)==null?void 0:N.name)||w(s==null?void 0:s.audio)||"Play Audio"}),e.jsx("audio",{src:h,controls:!0,preload:"metadata",className:"w-96 border rounded-3xl"},h)]})]}),e.jsx("button",{onClick:()=>m(null),className:"ml-4 text-gray-400 hover:text-gray-600 flex items-center justify-center",children:"✕"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row sm:justify-end gap-3 pt-6 mt-6 border-t border-gray-200",children:[e.jsx(R,{href:route("articles.index"),className:"inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-[10px] text-gray-600 border-2 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 transition duration-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center justify-center px-8 py-2 text-sm font-medium rounded-[10px] text-white bg-gradient-to-r from-blue-500 to-blue-500 transition duration-200 hover:from-blue-500 hover:to-blue-600",disabled:v,children:v?a?"Updating...":"Saving...":a?"Update Article":"Create Article"})]})]})]})})})]})}export{P as default};
