import{X as F,r as g,j as e,S as z,A as j}from"./app-oy554yv7.js";import{A as M}from"./AdminLayout-4I0T3Gtz.js";import{B as T}from"./Breadcrumb-Bb0-_AiX.js";import{S as Q}from"./save-D6zLBmCI.js";import{T as y,P as f}from"./trash-2-BE39OYzQ.js";import{c as N}from"./createLucideIcon-d4101D4x.js";const O=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],S=N("chevron-down",O);const P=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],D=N("chevron-up",P);function U(){const{datas:c}=F().props,h=c&&c.id,b=h?"Edit Quiz":"New Quiz",[l,p]=g.useState({title:c?.title||"",subject:c?.subject||"",groups:c?.groups||[],status:c?.status||"Draft",description:c?.description||""}),[i,u]=g.useState([]);g.useEffect(()=>{c?.questions?u(c.questions.map(t=>{if(t.type==="Matching"){let n=[];try{Array.isArray(t.options)?n=t.options.map(s=>typeof s=="object"&&s.left!==void 0&&s.right!==void 0?s:{left:s.left||"",right:s.right||""}):t.options&&(n=JSON.parse(t.options))}catch{n=[{left:"",right:""}]}(!n||n.length===0)&&(n=[{left:"",right:""}]);let r=[];try{Array.isArray(t.correct_answer)?r=t.correct_answer.map(s=>typeof s=="object"&&s.left!==void 0&&s.right!==void 0?s:{left:s.left||"",right:s.right||""}):t.correct_answer&&(r=JSON.parse(t.correct_answer))}catch{r=[]}return r||(r=[]),{...t,options:n,correct_answer:r}}return{...t,options:Array.isArray(t.options)?t.options:t.options?JSON.parse(t.options):["","","",""],correct_answer:t.type==="Checkboxes"?Array.isArray(t.correct_answer)?t.correct_answer:t.correct_answer?JSON.parse(t.correct_answer):[]:t.type==="True/False"?t.correct_answer===!0||t.correct_answer==="true"||t.correct_answer==="True"?"True":"False":t.correct_answer||""}})):u([{type:"Multiple Choice",text:"",options:["","","",""],correct_answer:""}])},[c]);const _=()=>{u([...i,{type:"Multiple Choice",text:"",options:["","","",""],correct_answer:""}])},v=t=>{u(i.filter((n,r)=>r!==t))},w=(t,n)=>{if(n<0||n>=i.length)return;const r=[...i],[s]=r.splice(t,1);r.splice(n,0,s),u(r)},d=(t,n,r)=>{u(i.map((s,o)=>o!==t?s:n==="type"&&r==="Matching"?{...s,type:r,options:s.options&&s.options.length?s.options:[{left:"",right:""}],correct_answer:s.correct_answer&&s.correct_answer.length?s.correct_answer:[]}:n==="type"&&r==="Multiple Choice"?{...s,type:r,options:["","","",""],correct_answer:""}:n==="type"&&r==="Checkboxes"?{...s,type:r,options:["","","",""],correct_answer:[]}:n==="type"&&r==="True/False"?{...s,type:r,options:[],correct_answer:""}:n==="type"&&r==="Fill-in-the-blank"?{...s,type:r,options:[],correct_answer:""}:{...s,[n]:r}))},C=(t,n,r)=>{u(i.map((s,o)=>{if(o!==t)return s;if(s.type==="Matching"){const a=[...s.options];return a[n]=r,{...s,options:a}}return{...s,options:s.options.map((a,x)=>x===n?r:a)}}))},m=(t,n)=>{u(i.map((r,s)=>{if(s!==t)return r;if(r.type==="Checkboxes"){let o=Array.isArray(r.correct_answer)?r.correct_answer:[];return o.includes(n)?o=o.filter(a=>a!==n):o=[...o,n],{...r,correct_answer:o}}else return r.type==="True/False"?{...r,correct_answer:n}:{...r,correct_answer:n}}))},k=t=>{t.preventDefault();const n={...l,questions:i.map(r=>r.type==="Matching"?{type:r.type,text:r.text,options:Array.isArray(r.options)?r.options.map(s=>({left:s.left||"",right:s.right||""})):[{left:"",right:""}],correct_answer:Array.isArray(r.correct_answer)?r.correct_answer.map(s=>({left:s.left||"",right:s.right||""})):[]}:{type:r.type,text:r.text,description:r.description,options:r.options,correct_answer:(r.type==="Checkboxes"||r.type==="True/False",r.correct_answer)})};h?j.patch(route("quizzes.update",c.id),n):j.post(route("quizzes.store"),n)},A=[{title:"Home",url:"/"},{title:"Quiz",url:route("quizzes.index")},{title:b,url:""}];return e.jsxs(M,{breadcrumb:e.jsx(T,{header:b,links:A}),children:[e.jsx(z,{title:b}),e.jsxs("form",{className:"min-h-screen w-full mx-auto space-y-6 mb-12",onSubmit:k,children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm px-6 md:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4 md:gap-6",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("label",{className:"block text-gray-800 mb-2 font-medium",children:"Quiz Name"}),e.jsx("input",{type:"text",value:l.title,onChange:t=>p({...l,title:t.target.value}),placeholder:"Enter name",className:"w-full py-2.5 px-3.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition",required:!0})]}),e.jsxs("div",{className:"w-full md:w-1/3",children:[e.jsx("label",{className:"block text-gray-800 mb-2 font-medium",children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"radio",name:"status",value:"Published",checked:l.status==="Published",onChange:()=>p({...l,status:"Published"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 accent-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 bg-blue-100/80 px-3 py-1.5 rounded-full",children:"Publish"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"radio",name:"status",value:"Draft",checked:l.status==="Draft",onChange:()=>p({...l,status:"Draft"}),className:"h-4 w-4 text-red-500 border-gray-300 focus:ring-red-400 accent-red-500"}),e.jsx("span",{className:"text-sm font-medium text-red-600 bg-gray-100 px-3 py-1.5 rounded-full",children:"Draft"})]})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center gap-2 px-6 w-36 py-2.5 text-white bg-blue-600 hover:bg-blue-700 rounded-xl shadow-sm transition-colors",children:[e.jsx(Q,{className:"w-4 h-4"})," ",h?"Update":"Create"]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-gray-800 mb-2 font-medium",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:t=>p({...l,description:t.target.value}),placeholder:"Enter quiz description",className:"w-full px-3.5 py-3 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition",rows:"3"})]})]}),e.jsxs("div",{className:"space-y-6",children:[i.map((t,n)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm px-6 md:px-8 py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Question ",n+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"flex items-center justify-center w-10 h-10 text-red-600 border border-red-200 rounded-xl hover:bg-red-50 transition-colors","aria-label":"Delete",onClick:()=>v(n),disabled:i.length===1,children:e.jsx(y,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",className:"flex items-center justify-center w-10 h-10 text-gray-600 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-40",onClick:()=>w(n,n-1),disabled:n===0,children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",className:"flex items-center justify-center w-10 h-10 text-gray-600 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors disabled:opacity-40",onClick:()=>w(n,n+1),disabled:n===i.length-1,children:e.jsx(S,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-800 mb-2 font-medium",children:"Question Type"}),e.jsxs("select",{value:t.type,onChange:r=>d(n,"type",r.target.value),className:"w-full md:w-1/3 py-2.5 px-3.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition",children:[e.jsx("option",{value:"Multiple Choice",children:"Multiple Choice"}),e.jsx("option",{value:"Checkboxes",children:"Checkboxes"}),e.jsx("option",{value:"True/False",children:"True/False"}),e.jsx("option",{value:"Fill-in-the-blank",children:"Fill-in-the-blank"}),e.jsx("option",{value:"Matching",children:"Matching"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-800 mb-2 font-medium",children:"Question"}),e.jsx("input",{type:"text",value:t.text,onChange:r=>d(n,"text",r.target.value),placeholder:"Enter your question",className:"w-full px-3.5 py-2.5 rounded-xl bg-gray-50 border border-gray-200 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition"})]}),(t.type==="Multiple Choice"||t.type==="Checkboxes")&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Options"}),t.options.map((r,s)=>e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("input",{type:t.type==="Multiple Choice"?"radio":"checkbox",name:`correctOption-${n}`,checked:t.type==="Checkboxes"?Array.isArray(t.correct_answer)&&t.correct_answer.includes(r):t.correct_answer===r,onChange:()=>m(n,r),className:"text-blue-600 focus:ring-blue-400 cursor-pointer"}),e.jsx("input",{type:"text",value:r,placeholder:`Option ${s+1}`,onChange:o=>C(n,s,o.target.value),className:"flex-1 px-3.5 py-2.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition"}),e.jsx("button",{type:"button",onClick:()=>d(n,"options",t.options.filter((o,a)=>a!==s)),className:"text-red-500 hover:text-red-600 transition-colors",disabled:t.options.length<=2,children:e.jsx(y,{className:"w-5 h-5"})})]},s)),e.jsxs("button",{type:"button",onClick:()=>d(n,"options",[...t.options,""]),className:"mt-2 inline-flex items-center gap-2 text-blue-700 hover:text-blue-800",children:[e.jsx(f,{className:"w-4 h-4"})," Add Option"]}),e.jsxs("div",{className:"mt-2 text-sm text-green-700",children:[t.type==="Checkboxes"&&Array.isArray(t.correct_answer)&&t.correct_answer.length>0&&e.jsxs(e.Fragment,{children:["Correct Answers: ",e.jsx("strong",{children:t.correct_answer.join(", ")})]}),t.type==="Multiple Choice"&&t.correct_answer&&e.jsxs(e.Fragment,{children:["Correct Answer: ",e.jsx("strong",{children:t.correct_answer})]})]})]}),t.type==="True/False"&&e.jsxs("div",{className:"flex gap-6 mt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`correctOption-${n}`,value:"True",checked:t.correct_answer==="True",onChange:r=>m(n,r.target.value),className:"cursor-pointer text-blue-600 focus:ring-blue-400"}),"True"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:`correctOption-${n}`,value:"False",checked:t.correct_answer==="False",onChange:r=>m(n,r.target.value),className:"cursor-pointer text-blue-600 focus:ring-blue-400"}),"False"]}),e.jsx("div",{className:"ml-4 text-sm text-green-700",children:t.correct_answer&&e.jsxs(e.Fragment,{children:["Correct Answer: ",e.jsx("strong",{children:t.correct_answer})]})})]}),t.type==="Matching"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Matching Pairs"}),(t.options&&t.options.length>0?t.options:[{left:"",right:""}]).map((r,s)=>e.jsxs("div",{className:"flex gap-3 items-center mb-3",children:[e.jsx("input",{type:"text",value:r.left||"",onChange:o=>{const a=[...t.options||[]];a[s]={...a[s],left:o.target.value},d(n,"options",a)},placeholder:`Left item ${s+1}`,className:"w-1/3 px-3.5 py-2.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition"}),e.jsx("input",{type:"text",value:r.right||"",onChange:o=>{const a=[...t.options||[]];a[s]={...a[s],right:o.target.value},d(n,"options",a)},placeholder:`Right item ${s+1}`,className:"w-1/3 px-3.5 py-2.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition"}),e.jsx("button",{type:"button",onClick:()=>{const o=t.options.filter((a,x)=>x!==s);d(n,"options",o)},className:"text-red-500 hover:text-red-600 transition-colors",disabled:(t.options||[]).length<=1,children:e.jsx(y,{className:"w-5 h-5"})})]},s)),e.jsxs("button",{type:"button",onClick:()=>{const r=[...t.options||[],{left:"",right:""}];d(n,"options",r)},className:"mt-2 inline-flex items-center gap-2 text-blue-700 hover:text-blue-800",children:[e.jsx(f,{className:"w-4 h-4"})," Add matching pair"]}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:"The matching pairs will be shuffled when taking the quiz"})]}),t.type==="Fill-in-the-blank"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Correct Answer"}),e.jsx("input",{type:"text",value:t.correct_answer,onChange:r=>m(n,r.target.value),className:"w-full md:w-1/2 px-3.5 py-2.5 rounded-xl border border-gray-200 bg-gray-50 focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500 outline-none transition"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:t.correct_answer&&e.jsxs(e.Fragment,{children:["Correct Answer: ",e.jsx("strong",{children:t.correct_answer})]})})]})]},n)),e.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center gap-2 px-5 py-2.5 text-blue-700 border border-blue-200 rounded-xl hover:bg-blue-50 transition-colors",children:[e.jsx(f,{className:"w-4 h-4"})," Add Question"]})]})]})]})}export{U as default};
