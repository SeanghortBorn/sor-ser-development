const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/components/components-homophone.BmTr8BPi.js","assets/vendor/vendor-react.CSh4geB6.js","assets/vendor/vendor-common.B_9lrMAm.js","assets/vendor/vendor-charts.30OvePoC.js","assets/css/vendor-common.aZNoc4xn.css","assets/components/components-common.mFbUzjoH.js","assets/vendor/vendor-inertia.HwN2lMYo.js","assets/vendor/vendor-ui.wXUDVBjR.js","assets/vendor/vendor-utils.BR2dU08x.js","assets/css/vendor-utils.qpx8Q8Bj.css","assets/vendor/vendor-animation.B6GxcyWq.js"])))=>i.map(i=>d[i]);
import{j as e,r as t}from"../vendor/vendor-react.CSh4geB6.js";import{u as a,H as s,L as r}from"../vendor/vendor-inertia.HwN2lMYo.js";import{a as i}from"../vendor/vendor-common.B_9lrMAm.js";import{e as n,E as c,H as l,G as o,f as d,M as u,g as m,F as h}from"../components/components-common.mFbUzjoH.js";import{u as p,a as x,b as f}from"../app/app-stores.B6Q8NkPq.js";import{h as y}from"../app/app-services.36HjUIvy.js";import{c as g,a as b}from"../components/components-homophone.BmTr8BPi.js";const j={},w=function(e,t,a){let s=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=a?.nonce||a?.getAttribute("nonce");s=e(t.map(e=>{if((e=function(e){return"/build/"+e}(e))in j)return;j[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),t?new Promise((t,a)=>{s.addEventListener("load",t),s.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},v=(a,s={})=>{const{fallback:r=e.jsx(n,{}),errorFallback:i=null,retryDelay:l=1e3,maxRetries:o=3}=s,d=(e,t=o,a=l)=>new Promise((s,r)=>{e().then(s).catch(i=>{setTimeout(()=>{0!==t?d(e,t-1,a).then(s,r):r(i)},a)})}),u=t.lazy(()=>d(a));return a=>e.jsx(c,{fallback:i,children:e.jsx(t.Suspense,{fallback:r,children:e.jsx(u,{...a})})})};function S(){const[e,a]=t.useState(null),[s,r]=t.useState(!1),[n,c]=t.useState(null),[l,o]=t.useState(!1),[d,u]=t.useState([]),[m,h]=t.useState(!1),[p,x]=t.useState([]),[f,y]=t.useState(!1),g=async(e,t,a,s={})=>{a(!0);try{for(const a of e)try{const e=await i.get(a,{params:s,headers:{Accept:"application/json"},validateStatus:e=>e<500});if(200===e.status){const a=e.data?.data??e.data??null;if(a)return void t(Array.isArray(a)&&a[0]||a)}}catch(r){continue}t(null)}catch(n){t(null)}finally{a(!1)}},b=async e=>{if(!e)return;const t=["/api/user-activities/stats","/api/user-activity-stats","/api/stats/user-activities"];await g(t,a,r,{grammar_checker_id:e})},j=async e=>{if(!e)return;const t=[`/api/user-homophone-accuracies?grammar_checker_id=${e}`,`/api/homophone-accuracies?grammar_checker_id=${e}`,`/api/accuracies?grammar_checker_id=${e}`];await g(t,c,o)},w=async e=>{if(e){h(!0);try{const t=await i.get("/api/user-comparison-activities",{params:{grammar_checker_id:e,limit:50},headers:{Accept:"application/json"}}),a=Array.isArray(t.data)?t.data:t.data?.data??[];u(a)}catch(t){u([])}finally{h(!1)}}},v=async e=>{if(!e)return;const t=["/api/user-audio-activities","/api/audio-activities"];y(!0);try{for(const s of t)try{const t=await i.get(s,{params:{grammar_checker_id:e},headers:{Accept:"application/json"},validateStatus:e=>e<500});if(200===t.status){const e=Array.isArray(t.data)?t.data:t.data?.data??[];return void x(e)}}catch(a){continue}x([])}catch(a){x([])}finally{y(!1)}};return{activityStats:e,loadingActivityStats:s,accuracyStats:n,loadingAccuracyStats:l,comparisonActivities:d,loadingComparisonActivities:m,audioActivities:p,loadingAudioActivities:f,fetchActivityStats:b,fetchAccuracyStats:j,fetchComparisonActivities:w,fetchAudioActivities:v,fetchAllStats:async e=>{await Promise.all([b(e),j(e),w(e),v(e)])},resetStats:()=>{a(null),c(null),u([]),x([])}}}const _=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.D),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"spinner"})}),A=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.H),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"spinner"})}),N=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"spinner"})}),k=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.C),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"spinner"})});const C=Object.freeze(Object.defineProperty({__proto__:null,default:function({articles:n=[],userRole:j}){const{auth:w}=a().props,v=w?.user?.id,{setUser:C,can:T}=p(),{success:E,error:I}=x(),{articleId:P,userText:D,comparisonResults:R,metrics:M,setUserText:L,initializeSession:F,setComparisonResults:z,calculateAccuracy:U,resetSession:H}=f();t.useEffect(()=>{w?.user&&C(w.user)},[w?.user,C]);const[W]=t.useState(n),[O,V]=t.useState(null),[$,B]=t.useState(""),[q,G]=t.useState(""),[X,Z]=t.useState(null),[J,K]=t.useState(!1),[Q,Y]=t.useState(!1),[ee,te]=t.useState(null),[ae,se]=t.useState(null),[re,ie]=t.useState(!1),[ne,ce]=t.useState(null),[le,oe]=t.useState({currentAccuracy:0,minRequired:70,bestAccuracy:0,comparisonAccuracy:0,currentTypingSpeed:0}),[de,ue]=t.useState(null),[me,he]=t.useState(0),[pe,xe]=t.useState(0),[fe,ye]=t.useState([]),[ge,be]=t.useState(!1),[je,we]=t.useState(!1),[ve,Se]=t.useState(!1),[_e,Ae]=t.useState(!1),[Ne,ke]=t.useState(!1),[Ce,Te]=t.useState(!1),[Ee,Ie]=t.useState(null),[Pe,De]=t.useState([]),[Re,Me]=t.useState(!1),[Le,Fe]=t.useState(null),[ze,Ue]=t.useState(()=>!0===w?.can?.student||!1!==w?.can?.student&&("undefined"!=typeof window&&void 0!==window.__canAccessLibrary?window.__canAccessLibrary:null)),[He,We]=t.useState(!1),Oe=t.useRef(null),Ve=t.useRef(!1),$e=t.useRef(),Be=t.useRef(""),qe=S(),Ge=S(),Xe=function(e,a,s,r){const n=t.useRef(null),[c,l]=t.useState(null),[o,d]=t.useState(!1),[u,m]=t.useState(null),[h,p]=t.useState(0),[x,f]=t.useState(0),[y,g]=t.useState(null),b=async(t,c={})=>{if(e&&a?.audios_id)try{await i.post("/api/track/audio-activity",{audio_id:a.audios_id,article_id:a.id,grammar_checker_id:s??null,activity_type:t,playback_position:n.current?.currentTime||0,session_id:r,...c})}catch(l){}};return{audioRef:n,audioUrl:c,isPlaying:o,audioError:u,currentTime:h,duration:x,togglePlay:async()=>{if(c&&n.current)if(o){const e=Date.now();g(e),n.current.pause(),d(!1),await b("audio_pause",{pause_duration:0})}else{let t=0;y&&(t=(Date.now()-y)/1e3,g(null));try{await n.current.play(),d(!0),await b("audio_play",{pause_duration:t})}catch(e){m("Failed to play audio. Please try again."),d(!1)}}else m("No audio available to play.")},skipForward:async()=>{n.current&&(n.current.currentTime=Math.min(n.current.currentTime+10,n.current.duration),await b("audio_forward"))},skipBackward:async()=>{n.current&&(n.current.currentTime=Math.max(n.current.currentTime-10,0),await b("audio_rewind"))},handleSeek:e=>{if(n.current){const t=e.currentTarget.getBoundingClientRect(),a=(e.clientX-t.left)/t.width;n.current.currentTime=a*n.current.duration}},handleTimeUpdate:()=>{n.current&&p(n.current.currentTime)},handleLoadedMetadata:()=>{n.current&&f(n.current.duration)},handleAudioEnded:()=>{d(!1),n.current&&(n.current.currentTime=0)},loadAudio:async e=>{if(e)try{const t=await i.get(`/api/audios/${e}`),a=t.data?.data;a&&a.file_path?(l(a.file_path),m(null)):(l(null),m("Audio file not found"))}catch(t){m("Unable to load audio for this article."),l(null)}else l(null)},resetAudio:()=>{n.current&&(n.current.pause(),n.current.currentTime=0),d(!1)},setAudioError:m}}(v,O,X,ne);t.useEffect(()=>{const e=`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;ce(e);try{sessionStorage.setItem("sessionId",e)}catch(t){}},[]),t.useEffect(()=>{if(null!==ze||!w?.user)return;let e=!1;return(async()=>{try{const t=(await fetch(route("api.user.can-access-library"),{headers:{"X-Requested-With":"XMLHttpRequest"}})).ok;e||(Ue(t),"undefined"!=typeof window&&(window.__canAccessLibrary=t))}catch(t){e||Ue(!1)}})(),()=>e=!0},[w?.user,ze]),t.useEffect(()=>{be(!w.user)},[w.user]),t.useEffect(()=>{if(!He)return;const e=e=>{Oe.current&&!Oe.current.contains(e.target)&&We(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[He]),t.useEffect(()=>{ue(null),he(0),xe(0),ye([])},[O?.id]),t.useEffect(()=>{O?F(O.id,O.content):H()},[O,F,H]);const Ze=e=>{if(isNaN(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`};t.useEffect(()=>{q.trim()&&O||(se(null),oe({currentAccuracy:0,minRequired:70,bestAccuracy:0,comparisonAccuracy:0,currentTypingSpeed:0}))},[q,O]),t.useEffect(()=>{if(!O)return void oe({currentAccuracy:0,minRequired:70,bestAccuracy:0,comparisonAccuracy:0,currentTypingSpeed:0});(async()=>{let e=0,t=0;ae?.user_words&&ae?.article_words?(e=ae.user_words.length,t=ae.article_words.length):e=await g(q);const a=t>0?Math.min(100,e/t*100):0,s=O.min_typed_words_percentage||70,r=O.best_accuracy||0,i=ae?.accuracy||0;let n=0;if(de&&q.trim()){const e=(Date.now()-de)/6e4,t=q.trim().split(/\s+/).length;n=e>0?Math.round(t/e):0}oe({currentAccuracy:a,minRequired:s,bestAccuracy:r,comparisonAccuracy:i,currentTypingSpeed:n})})()},[q,O,ae]);const Je=async()=>{Me(!0);const e=await(async()=>{if(!v)return[];try{const e=await i.get("/grammar-checkers",{headers:{Accept:"application/json"}});return Array.isArray(e.data)?e.data:e.data.data||[]}catch(e){return 401!==e.response?.status&&I("Failed to fetch history"),[]}})();De(e),Me(!1)},Ke=async()=>{if(O&&q.trim()){ie(!0);try{const e=await y.checkText({originalText:O.content,userText:q,articleId:O.id,userId:v,sessionId:ne});e&&Array.isArray(e.comparison)?(se(e),z(e),U(),E("Text comparison complete!")):(se(null),I("Invalid comparison result"))}catch(e){se(null),I("Failed to compare text. Please try again.")}finally{ie(!1)}}},Qe=async(e,t)=>{if(!v)return;K(!0);const a=await g(t),s={user_id:v,title:e??"",paragraph:t??"",word_count:a,incorrect_word_count:0,reading_time:b(a),article_id:O?O.id:null};if(X)try{const e=await i.patch(`/grammar-checkers/${X}`,s,{headers:{Accept:"application/json"}}),a=e.data?.id??e.data?.data?.id??X;Z(a),te(Date.now()),O&&t.trim()&&Ke()}catch(r){I("Failed to update document")}finally{K(!1)}else{if(Ve.current)return void K(!1);Ve.current=!0;try{const e=await i.post("/grammar-checkers",s,{headers:{Accept:"application/json"}}),a=e.data?.id??e.data?.data?.id??null;a&&(Z(a),E("Document created and saved")),te(Date.now()),O&&t.trim()&&Ke()}catch(r){I("Failed to save document")}finally{Ve.current=!1,K(!1)}}};t.useEffect(()=>{if(v&&($.trim()||q.trim()))return $e.current&&clearTimeout($e.current),$e.current=setTimeout(()=>{Qe($,q)},700),()=>clearTimeout($e.current)},[$,q]);const Ye=e=>{const t=e.target.value;if(!de&&t.length>0&&ue(Date.now()),L(t),!v||!X)return;const a=Be.current,s=a.length,r=t.length;if(r>s){const e=t.slice(s);setTimeout(()=>{e.split("").forEach(e=>{i.post("/api/track/typing",{grammar_checker_id:Number(X),user_id:Number(v),character:e,status:1}).catch(()=>{})})},80)}else if(r<s){const e=s-r,t=a.slice(-e);xe(t=>t+e),ye(a=>[...a,{timestamp:Date.now(),characters:t,count:e,position:r}]),setTimeout(()=>{t.split("").forEach(e=>{i.post("/api/track/typing",{grammar_checker_id:Number(X),user_id:Number(v),character:e,status:0}).catch(()=>{})})},80)}Be.current=t},et=async e=>{if(V(e),We(!1),B(e?e.title:""),!e)return Xe.resetAudio(),void Xe.setAudioError(null);const t=e.audios_id;t?await Xe.loadAudio(t):Xe.resetAudio(),X&&Qe($,q)},tt=async e=>{if(O?.id)try{let t=null;if(de&&q.trim()){const e=(Date.now()-de)/6e4,a=q.trim().split(/\s+/).length;t=e>0?Math.round(a/e):0}const a=await y.acceptComparison({userId:v,articleId:O.id,sessionId:ne,accuracy:e,typingSpeed:t,timeSpent:de?Math.round((Date.now()-de)/1e3):0,grammarCheckerId:X,metadata:{...M,accuracy:e}});if(a.success){const e={...a.completion,totalTimeSpent:de?Math.round((Date.now()-de)/1e3):0,deletedCharsCount:pe,deletedCharsDetail:fe};Ie(e),Te(!0),E("Completion saved successfully!"),oe(e=>({...e,bestAccuracy:a.completion.best_accuracy||e.bestAccuracy}))}else I("Failed to save completion")}catch(t){I("Failed to save completion. Please try again.")}},at=e=>{e.preventDefault(),we(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(s,{title:"Homophone Check"}),e.jsx(l,{}),e.jsx(o,{}),e.jsx("section",{className:"relative py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-row gap-4 transition-all duration-300 "+(ge?"blur-sm":""),children:[e.jsx(c,{fallback:e.jsx("div",{className:"flex-1 bg-white rounded-xl border border-red-200 shadow-sm p-6 h-[75vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-red-600 mb-2",children:"Editor Error"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load editor. Please refresh the page."})]})}),children:e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 shadow-sm p-6 h-[75vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[O?.audios_id||Xe.audioUrl?e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("audio",{ref:Xe.audioRef,src:Xe.audioUrl,onTimeUpdate:Xe.handleTimeUpdate,onLoadedMetadata:Xe.handleLoadedMetadata,onEnded:Xe.handleAudioEnded,className:"hidden"}),e.jsx("div",{className:"bg-white border border-gray-300 rounded-xl px-3 py-1 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Xe.togglePlay,disabled:!Xe.audioUrl,className:"w-6 h-6 flex items-center justify-center text-white rounded-full transition "+(Xe.audioUrl?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"),children:Xe.isPlaying?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsxs("div",{className:"flex space-x-0",children:[e.jsx("button",{onClick:Xe.skipBackward,disabled:!Xe.audioUrl,className:"w-8 h-8 flex items-center justify-center rounded-full transition "+(Xe.audioUrl?"hover:bg-gray-100":"opacity-50 cursor-not-allowed"),title:"Back 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),e.jsx("path",{d:"M3 3v5h5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})}),e.jsx("button",{onClick:Xe.skipForward,disabled:!Xe.audioUrl,className:"w-8 h-8 flex items-center justify-center rounded-full transition "+(Xe.audioUrl?"hover:bg-gray-100":"opacity-50 cursor-not-allowed"),title:"Forward 10s",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e.jsx("path",{d:"M21 3v5h-5"}),e.jsx("text",{x:"12",y:"16",fontSize:"8",fill:"currentColor",textAnchor:"middle",fontWeight:"bold",children:"10"})]})})]}),e.jsx("div",{className:"flex-1 flex items-center gap-2",children:Xe.audioUrl?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:Ze(Xe.currentTime)}),e.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full cursor-pointer relative",onClick:Xe.handleSeek,children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all",style:{width:`${Xe.currentTime/Xe.duration*100||0}%`}})}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[35px]",children:Ze(Xe.duration)})]}):e.jsx("span",{className:"text-xs text-gray-500 italic",children:"Loading audio..."})})]})})]}):e.jsx("div",{}),e.jsxs("div",{className:"relative w-64",ref:Oe,children:[e.jsxs("button",{type:"button",className:"w-full px-3 py-2.5 text-sm bg-white border border-gray-300 rounded-xl shadow-sm text-left flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>We(!He),children:[O?O.title:"Select an Article",e.jsx("svg",{className:"w-4 h-4 ml-2 transition-transform "+(He?"rotate-180":"rotate-0"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),He&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg z-50 max-h-60 overflow-y-auto hide-scrollbar",children:e.jsxs("div",{className:"px-2 py-2 space-y-1",children:[e.jsx("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm rounded-xl transition "+(O?"hover:bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700 font-medium"),onClick:()=>et(null),children:"Select an Article"}),W.map((t,a)=>e.jsx("button",{type:"button",disabled:!t.can_access,className:"w-full text-left px-4 py-2 text-sm rounded-lg transition "+(O&&O.id===t.id?"bg-blue-100 text-blue-700 font-medium":t.can_access?"hover:bg-gray-100 text-gray-700":"opacity-40 cursor-not-allowed text-gray-400"),onClick:()=>t.can_access&&et(t),title:t.can_access?"":t.lock_message,children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[!t.can_access&&e.jsx("span",{className:"text-sm",children:"ğŸ”’"}),e.jsx("span",{className:"font-mono text-gray-500",children:a+1}),". ",e.jsx("span",{children:t.title})]}),t.is_completed&&e.jsxs("div",{className:"ml-8 flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-green-100 text-green-800 border border-green-300",children:"Completed"}),t.best_accuracy&&e.jsxs("span",{className:"text-xs text-gray-600",children:["Best: ",t.best_accuracy,"%",t.typing_speed&&` â€¢ ${t.typing_speed} WPM`]})]})]})},t.id))]})})]})]}),e.jsx("div",{className:"relative mt-4",children:e.jsx("textarea",{className:"w-full h-[54vh] text-md bg-white border border-gray-200 rounded-xl py-3 px-3 focus:outline-none focus:ring-1 focus:ring-blue-500 placeholder-gray-500 resize-none overflow-y-auto hide-scrollbar "+(Q?"min-h-[50vh]":""),placeholder:"Type your text here...",value:q,onChange:e=>{G(e.target.value),Ye(e)},onInput:Ye,onDoubleClick:()=>Y(!Q),disabled:!O,onCopy:at,onPaste:at,onCut:at})}),e.jsx("div",{className:"flex justify-end items-center mt-1",children:e.jsx("button",{type:"button",onClick:async()=>{if(null!==ze)if(X){if(ae?.stats&&O){const e=ae.stats,t=ae.article_words?.length||0,a=e.same||0,s=t>0?a/t*100:0;await tt(s)}!0===ze?(Se(!0),await qe.fetchAllStats(X)):(Ae(!0),await Je())}else{K(!0);try{if(await Qe($,q),ae?.stats&&O){const e=ae.stats,t=ae.article_words?.length||0,a=e.same||0,s=t>0?a/t*100:0;await tt(s)}!0===ze?(Se(!0),setTimeout(()=>{X&&qe.fetchAllStats(X)},0)):(Ae(!0),await Je())}catch(e){I("Failed to save"),K(!1)}}else I("Permission check still in progress, please try again")},disabled:J||re||!q.trim()||null===ze,className:"px-6 py-1 rounded-xl font-medium transition "+(J||re||!q.trim()||null===ze?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:J||re?"Checking...":"Save"})})]})}),e.jsx(c,{fallback:e.jsx("div",{className:"w-80 bg-white rounded-xl border border-red-200 shadow-sm p-6 flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-red-600",children:"Sidebar unavailable"})}),children:e.jsx(d,{text:q,onReplace:G,checkerId:X,comparisonResult:ae,setComparisonResult:se,articleId:O?.id,isChecking:re,liveProgress:le,selectedArticle:O,currentAccuracy:(()=>{if(!ae?.stats||!ae?.article_words)return 0;const e=ae.stats.same||0,t=ae.article_words.length||0;return t>0?e/t*100:0})()})})]})})}),e.jsx(c,{fallback:null,children:e.jsx(_,{show:ve,onClose:()=>Se(!1),docTitle:$,paragraph:q,lastSavedAt:ee,statsData:{comparisonActivities:qe.comparisonActivities,accuracyStats:qe.accuracyStats,activityStats:qe.activityStats,audioActivities:qe.audioActivities,loadingAccuracyStats:qe.loadingAccuracyStats,loadingActivityStats:qe.loadingActivityStats,loadingAudioActivities:qe.loadingAudioActivities}})}),e.jsx(c,{fallback:null,children:e.jsx(A,{show:_e,onClose:()=>Ae(!1),historyItems:Pe,loading:Re,onViewItem:async e=>{Fe(e),ke(!0),await Ge.fetchAllStats(e.id)}})}),e.jsx(c,{fallback:null,children:e.jsx(N,{show:Ne,onClose:()=>{ke(!1),Fe(null)},historyItem:Le,statsData:{comparisonActivities:Ge.comparisonActivities,accuracyStats:Ge.accuracyStats,activityStats:Ge.activityStats,audioActivities:Ge.audioActivities,loadingAccuracyStats:Ge.loadingAccuracyStats,loadingActivityStats:Ge.loadingActivityStats,loadingAudioActivities:Ge.loadingAudioActivities}})}),e.jsx(c,{fallback:null,children:e.jsx(k,{show:Ce,completionData:Ee,onClose:()=>{Te(!1)}})}),ge&&e.jsx("div",{className:"absolute inset-0 bg-opacity-20 flex items-center justify-center z-10",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 p-8 w-full max-w-xl mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-gray-900 mb-2",children:"Create an account to get started"}),e.jsx("p",{className:"text-gray-600 text-md leading-relaxed font-sans",children:"Create a free SorSer account to start Grammar Checker with AI"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:route("auth.google"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Sign Up with Google"})]}),e.jsxs(r,{href:route("register"),className:"w-full flex items-center justify-center gap-3 px-3 py-3 border-[3px] border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:e.jsxs("svg",{className:"w-12 h-12 text-gray-700",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),e.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),e.jsx("span",{className:"font-medium text-gray-500",children:"Sign Up by Email"})]})]}),e.jsxs("div",{className:"mt-6 text-md",children:[e.jsx("span",{className:"text-gray-500",children:"Or "}),e.jsx(r,{href:route("login"),children:e.jsx("span",{className:"text-blue-500 font-medium",children:"Sign In"})})," ","to an existing account"]})]})})}),e.jsx(u,{show:je,onClose:()=>we(!1),maxWidth:"xl",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),we(!1)},className:"p-6 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Action Not Allowed"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Copy, paste, and cut actions are disabled while typing in this field."}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"inline-block px-2 py-0.5 text-xs font-medium text-red-800 bg-red-100 rounded",children:"Please type manually."})}),e.jsx("div",{className:"flex justify-end gap-3 mt-3",children:e.jsx("button",{type:"button",onClick:()=>we(!1),className:"rounded-[10px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",children:"Close"})})]})}),e.jsx(m,{}),e.jsx(h,{})]})}},Symbol.toStringTag,{value:"Module"})),T=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.A),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"list",minHeight:"400px"})}),E=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.E),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"text",minHeight:"500px"})}),I=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.d),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"spinner",minHeight:"300px"})}),P=v(()=>w(()=>import("../components/components-homophone.BmTr8BPi.js").then(e=>e.S),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])),{fallback:e.jsx(n,{type:"card",minHeight:"300px"})});const D=Object.freeze(Object.defineProperty({__proto__:null,default:function({articles:r=[],userRole:i}){const{auth:n}=a().props,l=n?.user?.id,{articleId:o,userText:d,comparisonResults:u,metrics:m,setUserText:h,initializeSession:p,setComparisonResults:g,calculateAccuracy:b,resetSession:j}=f(),{success:w,error:v}=x(),[S]=t.useState(r),[_,A]=t.useState(null),[N,k]=t.useState(""),[C,D]=t.useState(!1),[R,M]=t.useState(!1),[L,F]=t.useState(null),[z,U]=t.useState(!1);t.useEffect(()=>{_?(p(_.id,_.content),k(_.title)):(j(),k(""))},[_]);const H=()=>{g(null)};return e.jsxs(e.Fragment,{children:[e.jsx(s,{title:"Homophone Check"}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(c,{fallback:e.jsx("div",{className:"w-80 bg-white border-r border-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load sidebar"})}),children:e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx(T,{articles:S,selectedArticle:_,onSelectArticle:e=>{d&&!confirm("Switching articles will lose unsaved work. Continue?")||A(e)},completedArticleIds:[],lockedArticleIds:[]})})}),e.jsx(c,{fallback:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Editor Error"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed to load editor. Please refresh the page."})]})}),children:e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx(E,{article:_,title:N,userText:d,onTitleChange:k,onTextChange:e=>{h(e)},onSave:async e=>{if(_){M(!0);try{await y.updateChecker(_.id,{paragraph:e,docTitle:N}),F(new Date),w("Progress saved automatically")}catch(t){v("Failed to save progress")}finally{M(!1)}}},isSaving:R,lastSavedAt:L,isZoomed:z,onToggleZoom:()=>U(!z),onCheckText:async()=>{if(_&&d){D(!0);try{const e=await y.checkText({originalText:_.content,userText:d,articleId:_.id,userId:l,sessionId:Date.now().toString()});g(e),b(),w("Text comparison complete!")}catch(e){v("Failed to check text. Please try again.")}finally{D(!1)}}},isChecking:C,canCheck:!!d&&!C,showProgress:!0,progress:m,autoSave:!0})})}),e.jsx(c,{fallback:e.jsx("div",{className:"w-80 bg-white border-l border-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Stats unavailable"})}),children:e.jsx("div",{className:"w-80 flex-shrink-0 bg-white border-l border-gray-200 p-4 overflow-y-auto",children:e.jsx(P,{currentAccuracy:m.accuracy,bestAccuracy:m.accuracy,totalWords:m.totalWords,correctWords:m.correctWords,incorrectWords:m.incorrectWords,timeSpent:m.timeSpent,minRequired:70,showTarget:!0})})})]}),u&&e.jsx(c,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Comparison Error"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Failed to display comparison results."}),e.jsx("button",{onClick:H,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700",children:"Close"})]})}),children:e.jsx(I,{comparisonData:u,onAccept:async()=>{try{await y.acceptComparison({userId:l,articleId:_.id,sessionId:Date.now().toString(),accuracy:m.accuracy,metadata:m}),w("Result accepted! Moving to next article..."),g(null);const e=S.findIndex(e=>e.id===_.id);e<S.length-1&&A(S[e+1])}catch(e){v("Failed to save result")}},onDismiss:H,onClose:H,isProcessing:!1})})]})}},Symbol.toStringTag,{value:"Module"}));export{C as I,w as _,D as a};
