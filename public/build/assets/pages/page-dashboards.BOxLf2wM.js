import{u as M,r as l,B as d,au as m,av as y,f as P,j as e,a9 as U,i,aw as O,l as b,X as h,Y as g,n,o as c,ax as f,P as v,s as N,t as C,k as L,q as k,ay as B,az as w,g as T}from"../vendor/vendor-common.DkKXL0Tk.js";import{A as E}from"./page-articles.CWa6oHJj.js";import{b as _}from"../components/components-common.Cz_RKLYJ.js";const I=()=>{const{props:o}=M(),{auth:A,isAdmin:S=!1}=o,r=S||A?.user?.roles?.some(s=>s.name==="Admin"),D=l.useMemo(()=>{const s=o?.stats||{};return r?[{id:"homophones",value:s?.homophones?.count??"—",label:"Total Homophones",trend:s?.homophones?.change??"+0%",icon:d,color:"text-blue-500",borderColor:"border-blue-100",bgColor:"bg-blue-50"},{id:"quizzes",value:s?.quizzes?.count??"—",label:"Quizzes Created",trend:s?.quizzes?.change??"+0%",icon:m,color:"text-green-500",borderColor:"border-green-100",bgColor:"bg-green-50"},{id:"students",value:s?.students?.count??"—",label:"Students Registered",trend:s?.students?.change??"+0%",icon:y,color:"text-orange-500",borderColor:"border-orange-100",bgColor:"bg-orange-50"},{id:"sessions",value:s?.sessions?.count??"—",label:"Student Vs No-Permission",trend:s?.sessions?.change??"+0%",icon:P,color:"text-purple-500",borderColor:"border-purple-100",bgColor:"bg-purple-50"},{id:"activeUsers",value:s?.activeUsers?.count??"—",label:"Active Users (7d)",trend:s?.activeUsers?.change??"+0%",icon:y,color:"text-sky-500",borderColor:"border-sky-100",bgColor:"bg-sky-50"},{id:"avgWords",value:s?.avgWords?.count??"—",label:"Avg Words/Check (7d)",trend:s?.avgWords?.change??"+0%",icon:m,color:"text-emerald-500",borderColor:"border-emerald-100",bgColor:"bg-emerald-50"}]:[{id:"completed",value:s?.articles_completed??"0",label:"Articles Completed",trend:"+0%",icon:d,color:"text-blue-500",borderColor:"border-blue-100",bgColor:"bg-blue-50"},{id:"total",value:s?.total_articles??"0",label:"Total Articles",trend:"+0%",icon:d,color:"text-green-500",borderColor:"border-green-100",bgColor:"bg-green-50"},{id:"rate",value:`${s?.completion_rate??"0"}%`,label:"Completion Rate",trend:"+0%",icon:m,color:"text-purple-500",borderColor:"border-purple-100",bgColor:"bg-purple-50"}]},[o?.stats,r]),z=l.useMemo(()=>r?o?.weeklyData??[]:[],[o?.weeklyData,r]),p=["#3b82f6","#10b981","#f59e0b","#8b5cf6","#ef4444","#06b6d4"],u=l.useMemo(()=>(o?.topArticles??[]).map((t,W)=>({name:t.name,value:t.attempts??t.value??0,color:p[W%p.length]})),[o?.topArticles]),a=o?.comparison||{},R=l.useMemo(()=>r?a.trend7d||[]:[],[a.trend7d,r]),j=l.useMemo(()=>r?(a.distribution||[]).map((s,t)=>({...s,color:t===0?"#2563eb":"#f97316"})):[],[a.distribution,r]),K=l.useMemo(()=>{if(!r)return[];const s=a?.avgWordPerCheck||{},t=a?.avgChecksPerUser||{};return[{metric:"Avg Words/Check",Student:Number(s.student??0),"No Role":Number(s.norole??0)},{metric:"Avg Checks/User",Student:Number(t.student??0),"No Role":Number(t.norole??0)}]},[a?.avgWordPerCheck,a?.avgChecksPerUser,r]),x=l.useMemo(()=>o?.recentActivity??[],[o?.recentActivity]),$=({stat:s})=>{const t=s.icon;return e.jsxs("div",{className:`bg-white px-3 pb-2 pt-3 border-l-4 ${s.borderColor} shadow-sm rounded-xl flex flex-col hover:shadow-sm transition-shadow duration-200`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-800 text-sm font-semibold",children:s.label}),e.jsx("div",{className:`${s.color}`,children:e.jsx(t,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsxs("p",{className:"text-xs text-green-600 font-medium mt-1 flex items-center",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),s.trend," vs last month"]})]})]})};return e.jsxs(E,{breadcrumb:e.jsx(_,{header:r?"Admin Dashboard":"My Dashboard",links:[{title:"Home",url:"/"},{title:r?"Admin Dashboard":"My Dashboard",url:""}]}),children:[e.jsx(U,{title:"Dashboard"}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:`grid grid-cols-1 ${r?"md:grid-cols-2 lg:grid-cols-3":"md:grid-cols-3"} gap-4 mb-6`,children:D.map(s=>e.jsx($,{stat:s},s.id))}),r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Activity Overview"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Sessions and engagement last 7 days"})]}),e.jsx(i,{width:"100%",height:300,children:e.jsxs(O,{data:z,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorSessions",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorEngagement",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(b,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"day",stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(g,{stroke:"#9ca3af",style:{fontSize:"12px"}}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"12px"}}),e.jsx(c,{wrapperStyle:{fontSize:"12px"}}),e.jsx(f,{type:"monotone",dataKey:"sessions",stroke:"#3b82f6",fillOpacity:1,fill:"url(#colorSessions)"}),e.jsx(f,{type:"monotone",dataKey:"engagement",stroke:"#10b981",fillOpacity:1,fill:"url(#colorEngagement)"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Top Articles"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"By checks"})]}),e.jsx(i,{width:"100%",height:300,children:e.jsxs(v,{children:[e.jsx(N,{data:u,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,value:t})=>`${s.split("/")[0]}: ${t}`,outerRadius:80,fill:"#8884d8",dataKey:"value",style:{fontSize:"11px"},children:u.map((s,t)=>e.jsx(C,{fill:s.color},`cell-${t}`))}),e.jsx(n,{formatter:s=>`${s} checks`,contentStyle:{fontSize:"12px",borderRadius:"8px",border:"1px solid #e5e7eb"}})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Engagement Trend (7d)"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Student vs No-Role checks"})]}),e.jsx(i,{width:"100%",height:280,children:e.jsxs(L,{data:R,margin:{top:5,right:30,left:0,bottom:5},children:[e.jsx(b,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"day",stroke:"#9ca3af"}),e.jsx(g,{stroke:"#9ca3af"}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(c,{}),e.jsx(k,{type:"monotone",dataKey:"student",stroke:"#2563eb",strokeWidth:2,dot:{r:3},name:"Student"}),e.jsx(k,{type:"monotone",dataKey:"norole",stroke:"#f97316",strokeWidth:2,dot:{r:3},name:"No Role"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Checks Distribution"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Share of checks by group"})]}),e.jsx(i,{width:"100%",height:280,children:e.jsxs(v,{children:[e.jsx(N,{data:j,cx:"50%",cy:"50%",outerRadius:90,dataKey:"value",labelLine:!1,label:({name:s,value:t})=>`${s}: ${t}`,children:j.map((s,t)=>e.jsx(C,{fill:s.color},`cmp-${t}`))}),e.jsx(n,{formatter:(s,t)=>[`${s}`,t]}),e.jsx(c,{})]})})]})]}),e.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"KPI Comparison"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Student vs No-Role on Avg Words/Check and Avg Checks/User"})]}),e.jsx(i,{width:"100%",height:320,children:e.jsxs(B,{data:K,margin:{top:5,right:20,left:0,bottom:5},children:[e.jsx(b,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(h,{dataKey:"metric",stroke:"#9ca3af"}),e.jsx(g,{stroke:"#9ca3af"}),e.jsx(n,{contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(c,{}),e.jsx(w,{dataKey:"Student",fill:"#2563eb",radius:[4,4,0,0]}),e.jsx(w,{dataKey:"No Role",fill:"#f97316",radius:[4,4,0,0]})]})})]})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"My Recent Activity"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Your learning progress"})]}),e.jsx("div",{className:"space-y-3",children:x&&x.length>0?x.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(d,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.article?.title||"Article"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Completed on ",new Date(s.completed_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"text-green-600 font-semibold",children:"✓ Completed"})]},t)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No activity yet. Start learning!"})]})})]})]})]})};export{I as default};
