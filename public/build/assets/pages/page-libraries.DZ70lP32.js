import{r as s,u as B,a as d,j as t,a7 as G}from"../vendor/vendor-common.Cf4BX4gl.js";import{H as J,n as Q,F as V}from"../components/components-common.B19fwoAx.js";import"../vendor/vendor-utils.D2KLQA9U.js";function ae(){const[v,l]=s.useState([]),[X,N]=s.useState(!0),{auth:I}=B().props,i=I?.user?.id,[_,f]=s.useState(!1),[x,L]=s.useState(null),[o,R]=s.useState(null),D=s.useRef({}),[b,P]=s.useState(!1),[g,$]=s.useState(null),[r,S]=s.useState(""),[c,T]=s.useState(!1),p=s.useRef(null),[z,F]=s.useState(!1),[h,H]=s.useState(null),[E,y]=s.useState([]),[u,k]=s.useState([]),[M,C]=s.useState(!1),[A,Y]=s.useState(null),[Z,w]=s.useState(!0),O=()=>{if(!i){y([]),w(!1);return}w(!0),d.get("/tags",{headers:{Accept:"application/json"}}).then(e=>{const a=e.data.data||[];y(a.filter(n=>n.user_id===i))}).catch(()=>y([])).finally(()=>w(!1))};s.useEffect(()=>{N(!0),d.get("/grammar-checkers",{headers:{Accept:"application/json"}}).then(e=>{const a=Array.isArray(e.data)?e.data:e.data.data||[];l(i?a.filter(n=>n.user_id===i):[])}).catch(()=>l([])).finally(()=>N(!1))},[i]),s.useEffect(()=>{O()},[i]);const W=async e=>{e.preventDefault(),x&&(await d.delete(`/grammar-checkers/${x.id}`),f(!1),L(null),l(a=>a.filter(n=>n.id!==x.id)))};s.useEffect(()=>{function e(a){o!==null&&D.current[o]&&!D.current[o].contains(a.target)&&R(null)}return o!==null&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);const m=()=>{P(!1),$(null),S("")},q=async e=>{if(e&&e.preventDefault(),!(!r.trim()||!g)){T(!0);try{await d.patch(`/grammar-checkers/${g.id}`,{title:r,word_count:0,incorrect_word_count:0,reading_time:0}),l(a=>a.map(n=>n.id===g.id?{...n,title:r}:n)),m()}finally{T(!1)}}},j=()=>{F(!1),H(null),k([])},K=async e=>{if(e.preventDefault(),!!h){C(!0);try{await d.post(`/grammar-checkers/${h.id}/tags`,{tag_ids:u}),l(a=>a.map(n=>n.id===h.id?{...n,tags:E.filter(U=>u.includes(U.id))}:n)),j()}finally{C(!1)}}};return A&&v.filter(e=>e.tags&&e.tags.some(a=>a.id===A)),s.useEffect(()=>{b&&p.current&&p.current.focus()},[b]),t.jsxs("div",{className:"bg-[#f7f8fa]",children:[t.jsx(G,{title:"Library"}),t.jsx(J,{}),t.jsxs("div",{className:"min-h-screen w-full max-w-7xl mx-auto py-8",children:[t.jsx(Q,{}),b&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",onMouseDown:e=>{e.target===e.currentTarget&&m()},children:t.jsxs("form",{onSubmit:q,className:"bg-white rounded-2xl w-full max-w-lg",onMouseDown:e=>e.stopPropagation(),children:[t.jsx("div",{className:"flex justify-between items-center px-6 py-3",children:t.jsx("h2",{className:"text-2xl font-semibold text-blue-900",children:"Rename Document"})}),t.jsx("div",{className:"px-6 pb-1",children:t.jsx("input",{ref:p,type:"text",value:r,onChange:e=>S(e.target.value),className:"w-full rounded-xl border-none px-3 py-2.5 bg-blue-50 text-gray-700 placeholder-gray-400 focus:ring-2 focus:ring-blue-300 hover:bg-blue-100 focus:outline-none text-base font-semibold mb-4",placeholder:"Document Name",required:!0,disabled:c,onKeyDown:e=>{e.key==="Escape"&&m()}})}),t.jsxs("div",{className:"flex justify-between items-center px-6 pb-6",children:[t.jsx("button",{type:"button",onClick:m,disabled:c,className:"rounded-[15px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold disabled:opacity-60",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:c||!r.trim(),className:"rounded-[15px] px-9 py-1 bg-blue-600 text-white font-semibold hover:bg-blue-700 transition disabled:opacity-60",children:c?"Saving...":"Save"})]})]})}),_&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",onMouseDown:e=>{e.target===e.currentTarget&&f(!1)},children:t.jsxs("form",{onSubmit:W,className:"bg-white rounded-xl shadow-xl p-4 w-full max-w-xl",onMouseDown:e=>e.stopPropagation(),children:[t.jsx("div",{className:"flex justify-between items-center mb-2",children:t.jsx("h2",{className:"text-2xl font-semibold text-blue-900",children:"Delete this document"})}),t.jsx("p",{className:"text-gray-500 mb-6 mt-2 text-base",children:"Are you sure you want to delete this document? This cannot be undone."}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{type:"button",onClick:()=>f(!1),className:"rounded-[15px] border-2 border-gray-300 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold disabled:opacity-60",children:"Cancel"}),t.jsx("button",{type:"submit",className:"rounded-[15px] px-9 py-1 bg-red-500 text-white font-semibold hover:bg-red-600 transition disabled:opacity-60",children:"Delete"})]})]})}),z&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",onMouseDown:e=>{e.target===e.currentTarget&&j()},children:t.jsxs("form",{onSubmit:K,className:"bg-white rounded-2xl w-full max-w-md shadow-xl",onMouseDown:e=>e.stopPropagation(),children:[t.jsx("div",{className:"flex justify-between items-center px-6 py-3",children:t.jsx("h2",{className:"text-2xl font-semibold text-blue-900",children:"Edit Tags"})}),t.jsx("div",{className:"px-6 pb-1",children:E.map(e=>t.jsxs("button",{type:"button",className:`flex items-center w-full mb-3 rounded-xl border px-4 py-3 gap-3 transition text-base font-medium
                                ${u.includes(e.id)?"border-blue-500 ring-2 ring-blue-400":"border-gray-200 hover:bg-gray-50"}
                            `,style:{boxShadow:u.includes(e.id)?"0 0 0 2px #2563eb":void 0},onClick:()=>{k(a=>a.includes(e.id)?[]:[e.id])},children:[t.jsx("span",{className:"w-6 h-6 rounded-md",style:{backgroundColor:e.color,display:"inline-block"}}),t.jsx("span",{className:"font-medium",children:e.name})]},e.id))}),t.jsxs("div",{className:"flex justify-between items-center px-6 pb-6 mt-2",children:[t.jsx("button",{type:"button",onClick:j,className:"rounded-[15px] border-2 border-gray-200 px-8 py-1 text-gray-700 hover:bg-gray-100 transition font-semibold",disabled:M,style:{minWidth:110},children:"Cancel"}),t.jsx("button",{type:"submit",className:"rounded-[15px] px-9 py-1 bg-blue-600 text-white font-semibold hover:bg-blue-700 transition disabled:opacity-60",disabled:M,style:{minWidth:110},children:"Save"})]})]})})]}),t.jsx(V,{})]})}export{ae as default};
