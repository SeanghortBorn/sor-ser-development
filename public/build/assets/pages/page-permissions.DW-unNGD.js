import{r as i,t as A,j as e,a7 as M,am as p,at as b,ay as f,C as j,S as L,G as T,a4 as _}from"../vendor/vendor-common.CH-fBE_6.js";import{A as E}from"./page-articles.CZ8cW0dp.js";import{b as R}from"../components/components-common.D7W8eAaP.js";function H({auth:U,permissions:m,roles:o,users:d}){const[r,u]=i.useState(null),[n,y]=i.useState(""),[c,v]=i.useState("all"),{post:w,processing:N}=A(),h=i.useMemo(()=>{const s={};return m.forEach(t=>{const a=t.name.split("-"),l=a[0],x=a.slice(1).join("-");s[l]||(s[l]={name:l,permissions:[]}),s[l].permissions.push({...t,action:x})}),Object.values(s)},[m]),C=i.useMemo(()=>h.filter(s=>{const t=n===""||s.name.toLowerCase().includes(n.toLowerCase())||s.permissions.some(a=>a.name.toLowerCase().includes(n.toLowerCase()));return c==="all"?t:t&&s.permissions.some(a=>a.action.includes(c))}),[h,n,c]),S=i.useMemo(()=>r?r.type==="role"?o.find(t=>t.id===r.id)?.permissions||[]:d.find(t=>t.id===r.id)?.permissions||[]:[],[r,o,d]),g=s=>S.some(t=>t.id===s),P=s=>{if(!r){alert("Please select a role or user first");return}const t=g(s.id),a=r.type==="role"?t?"permissions.revoke-role":"permissions.grant-role":t?"permissions.revoke-user":"permissions.grant-user",l=r.type==="role"?{permission_id:s.id,role_id:r.id}:{permission_id:s.id,user_id:r.id};w(route(a),l,{preserveScroll:!0,preserveState:!0})},$=s=>s.includes("view")||s.includes("list")?"blue":s.includes("create")?"green":s.includes("edit")||s.includes("update")?"yellow":s.includes("delete")?"red":s.includes("manage")?"purple":"gray",k=s=>s.includes("view")||s.includes("list")?"ðŸ‘ï¸":s.includes("create")?"âž•":s.includes("edit")||s.includes("update")?"âœï¸":s.includes("delete")?"ðŸ—‘ï¸":s.includes("manage")?"âš™ï¸":"ðŸ”’";return e.jsxs(E,{breadcrumb:e.jsx(R,{header:"Permission Management",links:[{title:"Home",url:"/"},{title:"Permissions",url:""}]}),children:[e.jsx(M,{title:"Permissions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 px-4 py-4 border-l-4 border-blue-500 shadow-sm rounded-2xl transition-all duration-200 hover:shadow-md hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"Total Permissions"}),e.jsx("h2",{className:"text-3xl font-bold text-blue-900",children:m.length})]}),e.jsx("div",{className:"text-blue-500 bg-white p-3 rounded-2xl shadow-sm",children:e.jsx(p,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 px-4 py-4 border-l-4 border-green-500 shadow-sm rounded-2xl transition-all duration-200 hover:shadow-md hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"Roles"}),e.jsx("h2",{className:"text-3xl font-bold text-green-900",children:o.length})]}),e.jsx("div",{className:"text-green-500 bg-white p-3 rounded-2xl shadow-sm",children:e.jsx(b,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 px-4 py-4 border-l-4 border-purple-500 shadow-sm rounded-2xl transition-all duration-200 hover:shadow-md hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-700 text-sm font-medium mb-1",children:"Users"}),e.jsx("h2",{className:"text-3xl font-bold text-purple-900",children:d.length})]}),e.jsx("div",{className:"text-purple-500 bg-white p-3 rounded-2xl shadow-sm",children:e.jsx(f,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-2xl border border-gray-200 overflow-hidden transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 px-5 py-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("span",{className:"bg-white text-blue-600 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),"Select Target"]}),e.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"Choose a role or user"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Roles"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:o.map(s=>e.jsx("button",{onClick:()=>u({type:"role",id:s.id,name:s.name}),className:`w-full text-left px-4 py-3 rounded-2xl border-2 transition-all duration-200 ease-in-out hover:scale-105 active:scale-95 ${r?.type==="role"&&r?.id===s.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 hover:bg-gray-50 hover:shadow-sm"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.permissions?.length||0," permissions"]})]}),e.jsx(j,{className:`w-5 h-5 transition-transform duration-200 ${r?.type==="role"&&r?.id===s.id?"text-blue-600 rotate-90":"text-gray-400"}`})]})},s.id))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Users"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:d.slice(0,10).map(s=>e.jsx("button",{onClick:()=>u({type:"user",id:s.id,name:s.name}),className:`w-full text-left px-4 py-3 rounded-2xl border-2 transition-all duration-200 ease-in-out hover:scale-105 active:scale-95 ${r?.type==="user"&&r?.id===s.id?"border-purple-500 bg-purple-50 shadow-sm":"border-gray-200 hover:border-purple-300 hover:bg-gray-50 hover:shadow-sm"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.email})]}),e.jsx(j,{className:`w-5 h-5 transition-transform duration-200 ${r?.type==="user"&&r?.id===s.id?"text-purple-600 rotate-90":"text-gray-400"}`})]})},s.id))})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-2xl border border-gray-200 overflow-hidden transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:`bg-gradient-to-r px-5 py-4 ${r?"from-green-500 to-emerald-600":"from-gray-400 to-gray-500"}`,children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx("span",{className:"bg-white text-green-600 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),"Manage Permissions"]}),r?e.jsxs("p",{className:"text-green-100 text-sm mt-1",children:["Managing permissions for: ",e.jsx("span",{className:"font-semibold",children:r.name})]}):e.jsx("p",{className:"text-gray-100 text-sm mt-1",children:"Select a role or user to manage permissions"})]}),e.jsx("div",{className:"p-5",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-5 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search pages or permissions...",value:n,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("select",{value:c,onChange:s=>v(s.target.value),className:"border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"all",children:"All Actions"}),e.jsx("option",{value:"view",children:"View/List"}),e.jsx("option",{value:"create",children:"Create"}),e.jsx("option",{value:"edit",children:"Edit"}),e.jsx("option",{value:"delete",children:"Delete"}),e.jsx("option",{value:"manage",children:"Manage"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[600px] overflow-y-auto pr-2",children:C.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-4 hover:shadow-md transition-all duration-200 hover:border-blue-200 bg-gradient-to-br from-white to-gray-50",children:[e.jsxs("h4",{className:"font-semibold text-base text-gray-900 mb-3 capitalize flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:k(s.name)}),s.name.replace(/-/g," ")]}),e.jsx("div",{className:"space-y-2",children:s.permissions.map(t=>{const a=g(t.id),l=$(t.action),x={blue:a?"bg-blue-500 border-blue-600":"bg-gray-200 border-gray-300",green:a?"bg-green-500 border-green-600":"bg-gray-200 border-gray-300",yellow:a?"bg-yellow-500 border-yellow-600":"bg-gray-200 border-gray-300",red:a?"bg-red-500 border-red-600":"bg-gray-200 border-gray-300",purple:a?"bg-purple-500 border-purple-600":"bg-gray-200 border-gray-300",gray:a?"bg-gray-500 border-gray-600":"bg-gray-200 border-gray-300"};return e.jsxs("button",{onClick:()=>P(t),disabled:N,className:`w-full flex items-center justify-between px-3 py-2.5 rounded-xl border-2 transition-all duration-200 ease-in-out hover:scale-105 active:scale-95 ${a?`${x[l]} text-white shadow-sm`:"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100 hover:shadow-sm"}`,children:[e.jsx("span",{className:"text-sm font-medium capitalize",children:t.action.replace(/-/g," ")}),e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center transition-all duration-200 ${a?"bg-white bg-opacity-30":"bg-transparent"}`,children:a?e.jsx(T,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4 text-gray-400"})})]},t.id)})})]},s.name))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(p,{className:"w-20 h-20 mb-4 opacity-20"}),e.jsx("p",{className:"text-lg font-medium",children:"Select a role or user to begin"}),e.jsx("p",{className:"text-sm mt-2",children:"Choose from the list on the left to manage permissions"})]})})]})})]})]})}export{H as default};
